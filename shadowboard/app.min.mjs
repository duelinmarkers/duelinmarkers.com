var a=class{withFields(t){let n=Object.keys(this).map(r=>r in t?t[r]:this[r]);return new this.constructor(...n)}},z=class{static fromArray(t,n){let r=n||new Wt;for(let i=t.length-1;i>=0;--i)r=new $t(t[i],r);return r}[Symbol.iterator](){return new rr(this)}toArray(){return[...this]}atLeastLength(t){for(let n of this){if(t<=0)return!0;t--}return t<=0}hasLength(t){for(let n of this){if(t<=0)return!1;t--}return t===0}countLength(){let t=0;for(let n of this)t++;return t}};function $(e,t){return new $t(e,t)}function l(e,t){return z.fromArray(e,t)}var rr=class{#e;constructor(t){this.#e=t}next(){if(this.#e instanceof Wt)return{done:!0};{let{head:t,tail:n}=this.#e;return this.#e=n,{value:t,done:!1}}}},Wt=class extends z{},$t=class extends z{constructor(t,n){super(),this.head=t,this.tail=n}},ht=class e{constructor(t){if(!(t instanceof Uint8Array))throw"BitArray can only be constructed from a Uint8Array";this.buffer=t}get length(){return this.buffer.length}byteAt(t){return this.buffer[t]}floatFromSlice(t,n,r){return Ho(this.buffer,t,n,r)}intFromSlice(t,n,r,i){return Uo(this.buffer,t,n,r,i)}binaryFromSlice(t,n){return new e(this.buffer.slice(t,n))}sliceAfter(t){return new e(this.buffer.slice(t))}},Kt=class{constructor(t){this.value=t}};function Uo(e,t,n,r,i){let s=0;if(r)for(let o=t;o<n;o++)s=s*256+e[o];else for(let o=n-1;o>=t;o--)s=s*256+e[o];if(i){let u=2**((n-t)*8-1);s>=u&&(s-=u*2)}return s}function Ho(e,t,n,r){let i=new DataView(e.buffer),s=n-t;if(s===8)return i.getFloat64(t,!r);if(s===4)return i.getFloat32(t,!r);{let o=`Sized floats must be 32-bit or 64-bit on JavaScript, got size of ${s*8} bits`;throw new globalThis.Error(o)}}var Ve=class e extends a{static isResult(t){return t instanceof e}},p=class extends Ve{constructor(t){super(),this[0]=t}isOk(){return!0}},d=class extends Ve{constructor(t){super(),this[0]=t}isOk(){return!1}};function x(e,t){let n=[e,t];for(;n.length;){let r=n.pop(),i=n.pop();if(r===i)continue;if(!_i(r)||!_i(i)||!Qo(r,i)||Wo(r,i)||Ko(r,i)||Vo(r,i)||Yo(r,i)||Zo(r,i)||Xo(r,i))return!1;let o=Object.getPrototypeOf(r);if(o!==null&&typeof o.equals=="function")try{if(r.equals(i))continue;return!1}catch{}let[u,c]=Jo(r);for(let f of u(r))n.push(c(r,f),c(i,f))}return!0}function Jo(e){if(e instanceof Map)return[t=>t.keys(),(t,n)=>t.get(n)];{let t=e instanceof globalThis.Error?["message"]:[];return[n=>[...t,...Object.keys(n)],(n,r)=>n[r]]}}function Wo(e,t){return e instanceof Date&&(e>t||e<t)}function Ko(e,t){return e.buffer instanceof ArrayBuffer&&e.BYTES_PER_ELEMENT&&!(e.byteLength===t.byteLength&&e.every((n,r)=>n===t[r]))}function Vo(e,t){return Array.isArray(e)&&e.length!==t.length}function Yo(e,t){return e instanceof Map&&e.size!==t.size}function Zo(e,t){return e instanceof Set&&(e.size!=t.size||[...e].some(n=>!t.has(n)))}function Xo(e,t){return e instanceof RegExp&&(e.source!==t.source||e.flags!==t.flags)}function _i(e){return typeof e=="object"&&e!==null}function Qo(e,t){return typeof e!="object"&&typeof t!="object"&&(!e||!t)||[Promise,WeakSet,WeakMap,Function].some(r=>e instanceof r)?!1:e.constructor===t.constructor}function Ye(e,t){return t===0?0:e%t}function Me(e,t){return Math.trunc(mi(e,t))}function mi(e,t){return t===0?0:e/t}function Ze(e,t,n,r,i,s){let o=new globalThis.Error(i);o.gleam_error=e,o.module=t,o.line=n,o.function=r,o.fn=r;for(let u in s)o[u]=s[u];return o}var D=class extends a{},B=class extends a{},G=class extends a{};function xt(e,t,n){return e?t:n()}var _=class extends a{constructor(t){super(),this[0]=t}},h=class extends a{};function $i(e,t){if(e instanceof _){let n=e[0];return new p(n)}else return new d(t)}function Xe(e,t){return e instanceof _?e[0]:t}function wt(e,t){if(e instanceof _){let n=e[0];return new _(t(n))}else return new h}function $e(){return xi()}function gt(e,t,n){return gi(t,n,e)}function tl(e,t){for(;;){let n=e,r=t;if(n.hasLength(0))return r;{let i=n.head;e=n.tail,t=$(i,r)}}}function nl(e,t){for(;;){let n=e,r=t;if(n.hasLength(0))return tl(r,l([]));{let i=n.head;e=n.tail,t=$(i[0],r)}}}function rl(e){let t=Yt(e);return nl(t,l([]))}function ir(e){return rl(e)}function ol(e,t){for(;;){let n=e,r=t;if(n.atLeastLength(1))e=n.tail,t=r+1;else return r}}function bi(e){return ol(e,0)}function ll(e,t){for(;;){let n=e,r=t;if(n.hasLength(0))return r;{let i=n.head;e=n.tail,t=$(i,r)}}}function R(e){return ll(e,l([]))}function ki(e){if(e.hasLength(0))return new d(void 0);{let t=e.head;return new p(t)}}function ul(e,t,n){for(;;){let r=e,i=t,s=n;if(r.hasLength(0))return R(s);{let o=r.head,u=r.tail,c=i(o)?$(o,s):s;e=u,t=i,n=c}}}function Pe(e,t){return ul(e,t,l([]))}function al(e,t,n){for(;;){let r=e,i=t,s=n;if(r.hasLength(0))return R(s);{let o=r.head;e=r.tail,t=i,n=$(i(o),s)}}}function L(e,t){return al(e,t,l([]))}function cl(e,t,n){for(;;){let r=e,i=t,s=n;if(r.hasLength(0))return new p(R(s));{let o=r.head,u=r.tail,c=i(o);if(c.isOk()){let f=c[0];e=u,t=i,n=$(f,s)}else{let f=c[0];return new d(f)}}}}function yt(e,t){return cl(e,t,l([]))}function sr(e,t){for(;;){let n=e,r=t;if(r<=0)return n;if(n.hasLength(0))return l([]);e=n.tail,t=r-1}}function fl(e,t,n){for(;;){let r=e,i=t,s=n;if(i<=0)return R(s);if(r.hasLength(0))return R(s);{let u=r.head;e=r.tail,t=i-1,n=$(u,s)}}}function Ai(e,t){return fl(e,t,l([]))}function pl(e,t){for(;;){let n=e,r=t;if(n.hasLength(0))return r;{let i=n.head;e=n.tail,t=$(i,r)}}}function ue(e,t){return pl(R(e),t)}function dl(e,t){for(;;){let n=e,r=t;if(n.hasLength(0))return r;{let i=n.head;e=n.tail,t=$(i,r)}}}function _l(e,t){for(;;){let n=e,r=t;if(n.hasLength(0))return R(r);{let i=n.head;e=n.tail,t=dl(i,r)}}}function bt(e){return _l(e,l([]))}function vi(e,t){let n=L(e,t);return bt(n)}function J(e,t,n){for(;;){let r=e,i=t,s=n;if(r.hasLength(0))return i;{let o=r.head;e=r.tail,t=s(i,o),n=s}}}function ml(e,t,n,r){for(;;){let i=e,s=t,o=n,u=r;if(i.hasLength(0))return s;{let c=i.head;e=i.tail,t=o(s,c,u),n=o,r=u+1}}}function or(e,t,n){return ml(e,t,n,0)}function Zt(e,t){for(;;){let n=e,r=t;if(n.hasLength(0))return new d(void 0);{let i=n.head,s=n.tail;if(r(i))return new p(i);e=s,t=r}}}function $l(e,t){for(;;){let n=e,r=t;if(n.hasLength(0))return new d(void 0);{let i=n.head,s=n.tail,o=r(i);if(o.isOk()){let u=o[0];return new p(u)}else e=s,t=r}}}function lr(e,t){return $l(e,n=>{let r=n[0],i=n[1];return x(r,t)?new p(i):new d(void 0)})}function Li(e,t){for(;;){let n=e,r=t;if(n.hasLength(0))return l([]);{let i=n.head,s=n.tail;if(r(i))e=s,t=r;else return $(i,s)}}}function F(e,t){if(e.isOk()){let n=e[0];return new p(t(n))}else{let n=e[0];return new d(n)}}function ne(e,t){if(e.isOk()){let n=e[0];return new p(n)}else{let n=e[0];return new d(t(n))}}function W(e,t){if(e.isOk()){let n=e[0];return t(n)}else{let n=e[0];return new d(n)}}function kt(e,t){return W(e,t)}function Ti(e,t){return e.isOk()?e[0]:t}function Xt(e){return cr(e)}function et(e){return e}function fr(e){return zi(e)}function Ni(e){let n=Xt(e);return et(n)}function Mi(e,t,n){let i=ar(e),s=sr(i,t),o=Ai(s,n);return Ni(o)}function Pi(e,t,n){if(n<0)return"";if(t<0){let s=fr(e)+t;return s<0?"":Mi(e,s,n)}else return Mi(e,t,n)}function en(e,t){return t<0?e:Pi(e,t,fr(e)-t)}function At(e){let t=ce(e);return et(t)}var ke=class extends a{constructor(t,n,r){super(),this.expected=t,this.found=n,this.path=r}};function pr(e){return hr(e)}function he(e){return Di(e)}function tt(e){return Bi(e)}function Ll(e){return Gi(e)}function Fi(e){return t=>Ri(t,e)}function tn(e){return t=>{if(e.hasLength(0))return new d(l([new ke("another type",pr(t),l([]))]));{let n=e.head,r=e.tail,i=n(t);if(i.isOk()){let s=i[0];return new p(s)}else return tn(r)(t)}}}function V(e){return e.isOk()?l([]):e[0]}function dr(e,t){let n=t,r=tn(l([fe,s=>F(he(s),q)])),i=(()=>{let s=r(n);if(s.isOk())return s[0];{let o=l(["<",pr(n),">"]),u=Xt(o);return et(u)}})();return e.withFields({path:$(i,e.path)})}function nn(e){return t=>W(Ll(t),n=>{let i=yt(n,e);return _r(i,s=>dr(s,"*"))})}function _r(e,t){return ne(e,n=>L(n,t))}function fe(e){return Ii(e)}function O(e,t){return n=>{let r=new ke("field","nothing",l([]));return W(xr(n,e),i=>{let o=$i(i,l([r])),u=W(o,t);return _r(u,c=>dr(c,e))})}}function mr(e,t){return n=>W(xr(n,e),r=>{if(r instanceof h)return new p(new h);{let i=r[0],s=t(i),o=F(s,u=>new _(u));return _r(o,u=>dr(u,e))}})}function rn(e,t,n){return r=>{let i=t(r),s=n(r);if(i.isOk()&&s.isOk()){let o=i[0],u=s[0];return new p(e(o,u))}else{let o=i,u=s;return new d(bt(l([V(o),V(u)])))}}}function qi(e,t,n,r,i){return s=>{let o=t(s),u=n(s),c=r(s),f=i(s);if(o.isOk()&&u.isOk()&&c.isOk()&&f.isOk()){let m=o[0],b=u[0],y=c[0],M=f[0];return new p(e(m,b,y,M))}else{let m=o,b=u,y=c,M=f;return new d(bt(l([V(m),V(b),V(y),V(M)])))}}}function $r(e,t,n,r,i,s,o){return u=>{let c=t(u),f=n(u),m=r(u),b=i(u),y=s(u),M=o(u);if(c.isOk()&&f.isOk()&&m.isOk()&&b.isOk()&&y.isOk()&&M.isOk()){let N=c[0],me=f[0],ye=m[0],be=b[0],oe=y[0],g=M[0];return new p(e(N,me,ye,be,oe,g))}else{let N=c,me=f,ye=m,be=b,oe=y,g=M;return new d(bt(l([V(N),V(me),V(ye),V(be),V(oe),V(g)])))}}}var Ui=new WeakMap,wr=new DataView(new ArrayBuffer(8)),gr=0;function yr(e){let t=Ui.get(e);if(t!==void 0)return t;let n=gr++;return gr===2147483647&&(gr=0),Ui.set(e,n),n}function br(e,t){return e^t+2654435769+(e<<6)+(e>>2)|0}function Ar(e){let t=0,n=e.length;for(let r=0;r<n;r++)t=Math.imul(31,t)+e.charCodeAt(r)|0;return t}function Hi(e){wr.setFloat64(0,e);let t=wr.getInt32(0),n=wr.getInt32(4);return Math.imul(73244475,t>>16^t)^n}function Ol(e){return Ar(e.toString())}function El(e){let t=Object.getPrototypeOf(e);if(t!==null&&typeof t.hashCode=="function")try{let r=e.hashCode(e);if(typeof r=="number")return r}catch{}if(e instanceof Promise||e instanceof WeakSet||e instanceof WeakMap)return yr(e);if(e instanceof Date)return Hi(e.getTime());let n=0;if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||e instanceof Uint8Array)for(let r=0;r<e.length;r++)n=Math.imul(31,n)+Y(e[r])|0;else if(e instanceof Set)e.forEach(r=>{n=n+Y(r)|0});else if(e instanceof Map)e.forEach((r,i)=>{n=n+br(Y(r),Y(i))|0});else{let r=Object.keys(e);for(let i=0;i<r.length;i++){let s=r[i],o=e[s];n=n+br(Y(o),Ar(s))|0}}return n}function Y(e){if(e===null)return 1108378658;if(e===void 0)return 1108378659;if(e===!0)return 1108378657;if(e===!1)return 1108378656;switch(typeof e){case"number":return Hi(e);case"string":return Ar(e);case"bigint":return Ol(e);case"object":return El(e);case"symbol":return yr(e);case"function":return yr(e);default:return 0}}var de=5,vr=Math.pow(2,de),Sl=vr-1,Tl=vr/2,jl=vr/4,I=0,pe=1,H=2,Fe=3,Lr={type:H,bitmap:0,array:[]};function vt(e,t){return e>>>t&Sl}function ln(e,t){return 1<<vt(e,t)}function Cl(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function Or(e,t){return Cl(e&t-1)}function Z(e,t,n){let r=e.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=e[s];return i[t]=n,i}function Ml(e,t,n){let r=e.length,i=new Array(r+1),s=0,o=0;for(;s<t;)i[o++]=e[s++];for(i[o++]=n;s<r;)i[o++]=e[s++];return i}function kr(e,t){let n=e.length,r=new Array(n-1),i=0,s=0;for(;i<t;)r[s++]=e[i++];for(++i;i<n;)r[s++]=e[i++];return r}function Ji(e,t,n,r,i,s){let o=Y(t);if(o===r)return{type:Fe,hash:o,array:[{type:I,k:t,v:n},{type:I,k:i,v:s}]};let u={val:!1};return Lt(Er(Lr,e,o,t,n,u),e,r,i,s,u)}function Lt(e,t,n,r,i,s){switch(e.type){case pe:return Nl(e,t,n,r,i,s);case H:return Er(e,t,n,r,i,s);case Fe:return Pl(e,t,n,r,i,s)}}function Nl(e,t,n,r,i,s){let o=vt(n,t),u=e.array[o];if(u===void 0)return s.val=!0,{type:pe,size:e.size+1,array:Z(e.array,o,{type:I,k:r,v:i})};if(u.type===I)return x(r,u.k)?i===u.v?e:{type:pe,size:e.size,array:Z(e.array,o,{type:I,k:r,v:i})}:(s.val=!0,{type:pe,size:e.size,array:Z(e.array,o,Ji(t+de,u.k,u.v,n,r,i))});let c=Lt(u,t+de,n,r,i,s);return c===u?e:{type:pe,size:e.size,array:Z(e.array,o,c)}}function Er(e,t,n,r,i,s){let o=ln(n,t),u=Or(e.bitmap,o);if(e.bitmap&o){let c=e.array[u];if(c.type!==I){let m=Lt(c,t+de,n,r,i,s);return m===c?e:{type:H,bitmap:e.bitmap,array:Z(e.array,u,m)}}let f=c.k;return x(r,f)?i===c.v?e:{type:H,bitmap:e.bitmap,array:Z(e.array,u,{type:I,k:r,v:i})}:(s.val=!0,{type:H,bitmap:e.bitmap,array:Z(e.array,u,Ji(t+de,f,c.v,n,r,i))})}else{let c=e.array.length;if(c>=Tl){let f=new Array(32),m=vt(n,t);f[m]=Er(Lr,t+de,n,r,i,s);let b=0,y=e.bitmap;for(let M=0;M<32;M++){if(y&1){let N=e.array[b++];f[M]=N}y=y>>>1}return{type:pe,size:c+1,array:f}}else{let f=Ml(e.array,u,{type:I,k:r,v:i});return s.val=!0,{type:H,bitmap:e.bitmap|o,array:f}}}}function Pl(e,t,n,r,i,s){if(n===e.hash){let o=Sr(e,r);if(o!==-1)return e.array[o].v===i?e:{type:Fe,hash:n,array:Z(e.array,o,{type:I,k:r,v:i})};let u=e.array.length;return s.val=!0,{type:Fe,hash:n,array:Z(e.array,u,{type:I,k:r,v:i})}}return Lt({type:H,bitmap:ln(e.hash,t),array:[e]},t,n,r,i,s)}function Sr(e,t){let n=e.array.length;for(let r=0;r<n;r++)if(x(t,e.array[r].k))return r;return-1}function on(e,t,n,r){switch(e.type){case pe:return zl(e,t,n,r);case H:return Fl(e,t,n,r);case Fe:return ql(e,r)}}function zl(e,t,n,r){let i=vt(n,t),s=e.array[i];if(s!==void 0){if(s.type!==I)return on(s,t+de,n,r);if(x(r,s.k))return s}}function Fl(e,t,n,r){let i=ln(n,t);if(!(e.bitmap&i))return;let s=Or(e.bitmap,i),o=e.array[s];if(o.type!==I)return on(o,t+de,n,r);if(x(r,o.k))return o}function ql(e,t){let n=Sr(e,t);if(!(n<0))return e.array[n]}function Tr(e,t,n,r){switch(e.type){case pe:return Il(e,t,n,r);case H:return Dl(e,t,n,r);case Fe:return Bl(e,r)}}function Il(e,t,n,r){let i=vt(n,t),s=e.array[i];if(s===void 0)return e;let o;if(s.type===I){if(!x(s.k,r))return e}else if(o=Tr(s,t+de,n,r),o===s)return e;if(o===void 0){if(e.size<=jl){let u=e.array,c=new Array(e.size-1),f=0,m=0,b=0;for(;f<i;){let y=u[f];y!==void 0&&(c[m]=y,b|=1<<f,++m),++f}for(++f;f<u.length;){let y=u[f];y!==void 0&&(c[m]=y,b|=1<<f,++m),++f}return{type:H,bitmap:b,array:c}}return{type:pe,size:e.size-1,array:Z(e.array,i,o)}}return{type:pe,size:e.size,array:Z(e.array,i,o)}}function Dl(e,t,n,r){let i=ln(n,t);if(!(e.bitmap&i))return e;let s=Or(e.bitmap,i),o=e.array[s];if(o.type!==I){let u=Tr(o,t+de,n,r);return u===o?e:u!==void 0?{type:H,bitmap:e.bitmap,array:Z(e.array,s,u)}:e.bitmap===i?void 0:{type:H,bitmap:e.bitmap^i,array:kr(e.array,s)}}return x(r,o.k)?e.bitmap===i?void 0:{type:H,bitmap:e.bitmap^i,array:kr(e.array,s)}:e}function Bl(e,t){let n=Sr(e,t);if(n<0)return e;if(e.array.length!==1)return{type:Fe,hash:e.hash,array:kr(e.array,n)}}function Wi(e,t){if(e===void 0)return;let n=e.array,r=n.length;for(let i=0;i<r;i++){let s=n[i];if(s!==void 0){if(s.type===I){t(s.v,s.k);continue}Wi(s,t)}}}var Ae=class e{static fromObject(t){let n=Object.keys(t),r=e.new();for(let i=0;i<n.length;i++){let s=n[i];r=r.set(s,t[s])}return r}static fromMap(t){let n=e.new();return t.forEach((r,i)=>{n=n.set(i,r)}),n}static new(){return new e(void 0,0)}constructor(t,n){this.root=t,this.size=n}get(t,n){if(this.root===void 0)return n;let r=on(this.root,0,Y(t),t);return r===void 0?n:r.v}set(t,n){let r={val:!1},i=this.root===void 0?Lr:this.root,s=Lt(i,0,Y(t),t,n,r);return s===this.root?this:new e(s,r.val?this.size+1:this.size)}delete(t){if(this.root===void 0)return this;let n=Tr(this.root,0,Y(t),t);return n===this.root?this:n===void 0?e.new():new e(n,this.size-1)}has(t){return this.root===void 0?!1:on(this.root,0,Y(t),t)!==void 0}entries(){if(this.root===void 0)return[];let t=[];return this.forEach((n,r)=>t.push([r,n])),t}forEach(t){Wi(this.root,t)}hashCode(){let t=0;return this.forEach((n,r)=>{t=t+br(Y(n),Y(r))|0}),t}equals(t){if(!(t instanceof e)||this.size!==t.size)return!1;let n=!0;return this.forEach((r,i)=>{n=n&&x(t.get(i,!r),r)}),n}};var Gl=void 0,Ki={};function Zi(e){return e.toString()}function zi(e){if(e==="")return 0;let t=Xi(e);if(t){let n=0;for(let r of t)n++;return n}else return e.match(/./gsu).length}function ar(e){let t=Xi(e);return t?z.fromArray(Array.from(t).map(n=>n.segment)):z.fromArray(e.match(/./gsu))}function Xi(e){if(globalThis.Intl&&Intl.Segmenter)return new Intl.Segmenter().segment(e)[Symbol.iterator]()}function cr(e){let t="";for(let n of e)t=t+n;return t}var Qi=[" ","	",`
`,"\v","\f","\r","\x85","\u2028","\u2029"].join(""),tf=new RegExp(`^([${Qi}]*)`,"g"),nf=new RegExp(`([${Qi}]*)$`,"g");function es(e){console.log(e)}function ts(e){typeof process=="object"&&process.stderr?.write?process.stderr.write(e+`
`):typeof Deno=="object"?Deno.stderr.writeSync(new TextEncoder().encode(e+`
`)):console.log(e)}function xi(){return Ae.new()}function Yt(e){return z.fromArray(e.entries())}function wi(e,t){let n=e.get(t,Ki);return n===Ki?new d(Gl):new p(n)}function gi(e,t,n){return n.set(e,t)}function hr(e){if(typeof e=="string")return"String";if(typeof e=="boolean")return"Bool";if(e instanceof Ve)return"Result";if(e instanceof z)return"List";if(e instanceof ht)return"BitArray";if(e instanceof Ae)return"Dict";if(Number.isInteger(e))return"Int";if(Array.isArray(e))return`Tuple of ${e.length} elements`;if(typeof e=="number")return"Float";if(e===null)return"Null";if(e===void 0)return"Nil";{let t=typeof e;return t.charAt(0).toUpperCase()+t.slice(1)}}function Ot(e,t){return Rl(e,hr(t))}function Rl(e,t){return new d(z.fromArray([new ke(e,t,z.fromArray([]))]))}function Ii(e){return typeof e=="string"?new p(e):Ot("String",e)}function Di(e){return Number.isInteger(e)?new p(e):Ot("Int",e)}function Bi(e){return typeof e=="boolean"?new p(e):Ot("Bool",e)}function Gi(e){return Array.isArray(e)?new p(z.fromArray(e)):e instanceof z?new p(e):Ot("List",e)}function Ri(e,t){if(e==null||e instanceof h)return new p(new h);e instanceof _&&(e=e[0]);let n=t(e);return n.isOk()?new p(new _(n[0])):n}function xr(e,t){let n=()=>Ot("Dict",e);if(e instanceof Ae||e instanceof WeakMap||e instanceof Map){let r=wi(e,t);return new p(r.isOk()?new _(r[0]):new h)}else return e===null?n():Object.getPrototypeOf(e)==Object.prototype?Vi(e,t,()=>new p(new h)):Vi(e,t,n)}function Vi(e,t,n){try{return t in e?new p(new _(e[t])):n()}catch{return n()}}function ce(e){let t=typeof e;if(e===!0)return"True";if(e===!1)return"False";if(e===null)return"//js(null)";if(e===void 0)return"Nil";if(t==="string")return Ul(e);if(t==="bigint"||t==="number")return e.toString();if(Array.isArray(e))return`#(${e.map(ce).join(", ")})`;if(e instanceof z)return Kl(e);if(e instanceof Kt)return Yl(e);if(e instanceof ht)return Vl(e);if(e instanceof a)return Wl(e);if(e instanceof Ae)return Hl(e);if(e instanceof Set)return`//js(Set(${[...e].map(ce).join(", ")}))`;if(e instanceof RegExp)return`//js(${e})`;if(e instanceof Date)return`//js(Date("${e.toISOString()}"))`;if(e instanceof Function){let n=[];for(let r of Array(e.length).keys())n.push(String.fromCharCode(r+97));return`//fn(${n.join(", ")}) { ... }`}return Jl(e)}function Ul(e){let t='"';for(let n=0;n<e.length;n++){let r=e[n];switch(r){case`
`:t+="\\n";break;case"\r":t+="\\r";break;case"	":t+="\\t";break;case"\f":t+="\\f";break;case"\\":t+="\\\\";break;case'"':t+='\\"';break;default:r<" "||r>"~"&&r<"\xA0"?t+="\\u{"+r.charCodeAt(0).toString(16).toUpperCase().padStart(4,"0")+"}":t+=r}}return t+='"',t}function Hl(e){let t="dict.from_list([",n=!0;return e.forEach((r,i)=>{n||(t=t+", "),t=t+"#("+ce(i)+", "+ce(r)+")",n=!1}),t+"])"}function Jl(e){let t=Object.getPrototypeOf(e)?.constructor?.name||"Object",n=[];for(let s of Object.keys(e))n.push(`${ce(s)}: ${ce(e[s])}`);let r=n.length?" "+n.join(", ")+" ":"";return`//js(${t==="Object"?"":t+" "}{${r}})`}function Wl(e){let t=Object.keys(e).map(n=>{let r=ce(e[n]);return isNaN(parseInt(n))?`${n}: ${r}`:r}).join(", ");return t?`${e.constructor.name}(${t})`:e.constructor.name}function Kl(e){return`[${e.toArray().map(ce).join(", ")}]`}function Vl(e){return`<<${Array.from(e.buffer).join(", ")}>>`}function Yl(e){return`//utfcodepoint(${String.fromCodePoint(e.value)})`}function sn(e){return e>=0?e:e*-1}function q(e){return Zi(e)}function qe(e,t){return e>t?e:t}function jr(e,t){return e+t}var rt=class extends a{constructor(t){super(),this[0]=t}},Ie=class extends a{},De=class extends a{},re=class extends a{},Be=class extends a{},Ge=class extends a{},Re=class extends a{},Et=class extends a{},Ue=class extends a{},He=class extends a{};function xe(e,t){return[Me(e,t),Ye(e,t)]}var is=1e3;var Cr=1e6;function un(e){return new rt(e*Cr)}var ss=6e7;var Mr=36e8;function os(e){return new rt(e*Mr)}var ls=864e8;var us=6048e8;var as=2592e9;var cs=31536e9;function Nr(e){let t=e[0],n=sn(t),r=xe(n,cs),i=r[0],s=r[1],o=xe(s,as),u=o[0],c=o[1],f=xe(c,us),m=f[0],b=f[1],y=xe(b,ls),M=y[0],N=y[1],me=xe(N,Mr),ye=me[0],be=me[1],oe=xe(be,ss),g=oe[0],v=oe[1],T=xe(v,Cr),te=T[0],_t=T[1],di=xe(_t,is),Do=di[0],Bo=di[1],Go=l([[i,new He],[u,new Ue],[m,new Et],[M,new Re],[ye,new Ge],[g,new Be],[te,new re],[Do,new De],[Bo,new Ie]]),Ro=Pe(Go,mt=>mt[0]>0);return L(Ro,mt=>t<0?[-1*mt[0],mt[1]]:mt)}var ru=l([[new He,cs],[new Ue,as],[new Et,us],[new Re,ls],[new Ge,Mr],[new Be,ss],[new re,Cr],[new De,is],[new Ie,1]]);function an(e,t){let n=lr(ru,t);if(!n.isOk())throw Ze("let_assert","birl/duration",207,"blur_to","Pattern match failed, no pattern matched the value.",{value:n});let r=n[0],i=e[0],s=xe(i,r),o=s[0];return s[1]>=Me(r*2,3)?o+1:o}function fs(){return Date.now()*1e3}function ps(){return Math.floor(globalThis.performance.now()*1e3)}var it=class extends a{constructor(t,n,r,i){super(),this.wall_time=t,this.offset=n,this.timezone=r,this.monotonic_time=i}};function zr(e){{let t=e.wall_time;return Me(t,1e6)}}function ms(e){return new it(e*1e6,0,new h,new h)}function $s(e,t){let n=e.wall_time,r=e.monotonic_time,i=t.wall_time,s=t.monotonic_time,o=(()=>{if(r instanceof _&&s instanceof _){let b=r[0],y=s[0];return[b,y]}else return[n,i]})(),u=o[0],c=o[1],f=u===c,m=u<c;return f?new B:m?new D:new G}function cn(e,t){let n=e.wall_time,r=e.monotonic_time,i=t.wall_time,s=t.monotonic_time,o=(()=>{if(r instanceof _&&s instanceof _){let f=r[0],m=s[0];return[f,m]}else return[n,i]})(),u=o[0],c=o[1];return new rt(u-c)}function hs(e,t){let n=e.wall_time,r=e.offset,i=e.timezone,s=e.monotonic_time,o=t[0];if(s instanceof _){let u=s[0];return new it(n+o,r,i,new _(u+o))}else return new it(n+o,r,i,new h)}function Fr(){let e=fs(),t=ps();return new it(e,0,new _("Etc/UTC"),new _(t))}function ws(e){return es(e)}function qr(e){let n=At(e);return ts(n),e}function Ir(e){return JSON.stringify(e)}function gs(e){return Object.fromEntries(e)}function ys(e){return e.toArray()}function bs(){return null}function ks(e){try{let t=JSON.parse(e);return new p(t)}catch(t){return new d(lu(t,e))}}function lu(e,t){return uu(e)?new pn:au(e,t)}function uu(e){return/((unexpected (end|eof))|(end of data)|(unterminated string)|(json( parse error|\.parse)\: expected '(\:|\}|\])'))/i.test(e.message)}function au(e,t){let n=[cu,fu,du,pu];for(let r of n){let i=r(e,t);if(i)return i}return new ve("",0)}function cu(e){let n=/unexpected token '(.)', ".+" is not valid JSON/i.exec(e.message);if(!n)return null;let r=fn(n[1]);return new ve(r,-1)}function fu(e){let n=/unexpected token (.) in JSON at position (\d+)/i.exec(e.message);if(!n)return null;let r=fn(n[1]),i=Number(n[2]);return new ve(r,i)}function pu(e,t){let r=/(unexpected character|expected .*) at line (\d+) column (\d+)/i.exec(e.message);if(!r)return null;let i=Number(r[2]),s=Number(r[3]),o=_u(i,s,t),u=fn(t[o]);return new ve(u,o)}function du(e){let n=/unexpected (identifier|token) "(.)"/i.exec(e.message);if(!n)return null;let r=fn(n[2]);return new ve(r,0)}function fn(e){return"0x"+e.charCodeAt(0).toString(16).toUpperCase()}function _u(e,t,n){if(e===1)return t-1;let r=1,i=0;return n.split("").find((s,o)=>(s===`
`&&(r+=1),r===e?(i=o+t,!0):!1)),i}var pn=class extends a{},ve=class extends a{constructor(t,n){super(),this.byte=t,this.position=n}};var Dr=class extends a{constructor(t){super(),this[0]=t}};function mu(e,t){return kt(ks(e),n=>{let r=t(n);return ne(r,i=>new Dr(i))})}function As(e,t){return mu(e,t)}function vs(e){return Ir(e)}function Je(e){return e}function We(e){return e}function ie(e){return e}function $u(){return bs()}function Ls(e,t){if(e instanceof _){let n=e[0];return t(n)}else return $u()}function Le(e){return gs(e)}function Gr(e){return ys(e)}function St(e,t){let r=L(e,t);return Gr(r)}var Tt=class extends a{constructor(t){super(),this.all=t}};function hu(e){return new Tt(l([t=>e(t.dispatch,t.emit,t.select)]))}function st(e){return hu((t,n,r)=>e(t))}function we(){return new Tt(l([]))}function Os(e){return new Tt(J(e,l([]),(t,n)=>{let r=n.all;return ue(t,r)}))}var ot=class extends a{constructor(t){super(),this.content=t}},E=class extends a{constructor(t,n,r,i,s,o,u){super(),this.key=t,this.namespace=n,this.tag=r,this.attrs=i,this.children=s,this.self_closing=o,this.void=u}},jt=class extends a{constructor(t){super(),this.subtree=t}};var lt=class extends a{constructor(t,n,r){super(),this[0]=t,this[1]=n,this.as_property=r}},Ct=class extends a{constructor(t,n){super(),this[0]=t,this[1]=n}};function wu(e){if(e instanceof lt)return new d(void 0);{let t=e[0],n=e[1],r=en(t,2);return new p([r,n])}}function Es(e,t,n){return or(e,t,(r,i,s)=>{let o=n+"-"+q(s);return Ss(i,r,o)})}function Ss(e,t,n){for(;;){let r=e,i=t,s=n;if(r instanceof ot)return i;if(r instanceof jt){let o=r.subtree;e=o(),t=i,n=s}else if(r instanceof E){let o=r.attrs,u=r.children,c=J(o,i,(f,m)=>{let b=wu(m);if(b.isOk()){let y=b[0][0],M=b[0][1];return gt(f,s+"-"+y,M)}else return f});return Es(u,c,s)}else{let o=r.elements;return Es(o,i,s)}}}function Ts(e){return Ss(e,$e(),"0")}function Ke(e,t){return new lt(e,t,!1)}function Cs(e,t){return new Ct("on"+e,t)}function Ms(e){return Ke("style",J(e,"",(t,n)=>{let r=n[0],i=n[1];return t+r+":"+i+";"}))}function k(e){return Ke("class",e)}function X(e){return Ke("id",e)}function Oe(e){return Ke("title",e)}function Ns(e){return Ke("type",e)}function Ps(e){return Ke("value",e)}function Rr(e){return Ke("href",e)}function ut(e,t,n){return e==="area"?new E("","",e,t,l([]),!1,!0):e==="base"?new E("","",e,t,l([]),!1,!0):e==="br"?new E("","",e,t,l([]),!1,!0):e==="col"?new E("","",e,t,l([]),!1,!0):e==="embed"?new E("","",e,t,l([]),!1,!0):e==="hr"?new E("","",e,t,l([]),!1,!0):e==="img"?new E("","",e,t,l([]),!1,!0):e==="input"?new E("","",e,t,l([]),!1,!0):e==="link"?new E("","",e,t,l([]),!1,!0):e==="meta"?new E("","",e,t,l([]),!1,!0):e==="param"?new E("","",e,t,l([]),!1,!0):e==="source"?new E("","",e,t,l([]),!1,!0):e==="track"?new E("","",e,t,l([]),!1,!0):e==="wbr"?new E("","",e,t,l([]),!1,!0):new E("","",e,t,n,!1,!1)}function zs(e){return new ot(e)}var Hr=class extends a{constructor(t){super(),this.dict=t}};function Fs(){return new Hr($e())}var mn=class extends a{constructor(t){super(),this[0]=t}},$n=class extends a{constructor(t,n){super(),this[0]=t,this[1]=n}},hn=class extends a{constructor(t,n){super(),this[0]=t,this[1]=n}};function qs(e){return x(e.created,$e())&&x(e.removed,Fs())&&x(e.updated,$e())}var xn=class extends a{constructor(t){super(),this[0]=t}},wn=class extends a{constructor(t,n){super(),this[0]=t,this[1]=n}},Mt=class extends a{constructor(t){super(),this[0]=t}},_e=class extends a{constructor(t){super(),this[0]=t}},Nt=class extends a{constructor(t,n){super(),this[0]=t,this[1]=n}},gn=class extends a{constructor(t,n){super(),this[0]=t,this[1]=n}};var Pt=class extends a{},yn=class extends a{constructor(t,n){super(),this[0]=t,this[1]=n}},bn=class extends a{constructor(t){super(),this[0]=t}},kn=class extends a{constructor(t){super(),this[0]=t}};function Jr(e,t,n){let r,i=[{prev:e,next:t,parent:e.parentNode}];for(;i.length;){let{prev:s,next:o,parent:u}=i.pop();for(;o.subtree!==void 0;)o=o.subtree();if(o.content!==void 0)if(s)if(s.nodeType===Node.TEXT_NODE)s.textContent!==o.content&&(s.textContent=o.content),r??=s;else{let c=document.createTextNode(o.content);u.replaceChild(c,s),r??=c}else{let c=document.createTextNode(o.content);u.appendChild(c),r??=c}else if(o.tag!==void 0){let c=Ou({prev:s,next:o,dispatch:n,stack:i});s?s!==c&&u.replaceChild(c,s):u.appendChild(c),r??=c}else if(o.elements!==void 0)for(let c of vn(o))i.unshift({prev:s,next:c,parent:u}),s=s?.nextSibling}return r}function Ou({prev:e,next:t,dispatch:n,stack:r}){let i=t.namespace||"http://www.w3.org/1999/xhtml",s=e&&e.nodeType===Node.ELEMENT_NODE&&e.localName===t.tag&&e.namespaceURI===(t.namespace||"http://www.w3.org/1999/xhtml"),o=s?e:i?document.createElementNS(i,t.tag):document.createElement(t.tag),u;if(zt.has(o))u=zt.get(o);else{let g=new Map;zt.set(o,g),u=g}let c=s?new Set(u.keys()):null,f=s?new Set(Array.from(e.attributes,g=>g.name)):null,m=null,b=null,y=null;if(s&&t.tag==="textarea"){let g=t.children[Symbol.iterator]().next().value?.content;g!==void 0&&(o.value=g)}let M=[];for(let g of t.attrs){let v=g[0],T=g[1];if(g.as_property)o[v]!==T&&(o[v]=T),s&&f.delete(v);else if(v.startsWith("on")){let te=v.slice(2),_t=n(T,te==="input");u.has(te)||o.addEventListener(te,Ft),u.set(te,_t),s&&c.delete(te)}else if(v.startsWith("data-lustre-on-")){let te=v.slice(15),_t=n(Eu);u.has(te)||o.addEventListener(te,Ft),u.set(te,_t),o.setAttribute(v,T)}else v.startsWith("delegate:data-")||v.startsWith("delegate:aria-")?(o.setAttribute(v,T),M.push([v.slice(10),T])):v==="class"?m=m===null?T:m+" "+T:v==="style"?b=b===null?T:b+T:v==="dangerous-unescaped-html"?y=T:(o.getAttribute(v)!==T&&o.setAttribute(v,T),(v==="value"||v==="selected")&&(o[v]=T),s&&f.delete(v))}if(m!==null&&(o.setAttribute("class",m),s&&f.delete("class")),b!==null&&(o.setAttribute("style",b),s&&f.delete("style")),s){for(let g of f)o.removeAttribute(g);for(let g of c)u.delete(g),o.removeEventListener(g,Ft)}if(t.tag==="slot"&&window.queueMicrotask(()=>{for(let g of o.assignedElements())for(let[v,T]of M)g.hasAttribute(v)||g.setAttribute(v,T)}),t.key!==void 0&&t.key!=="")o.setAttribute("data-lustre-key",t.key);else if(y!==null)return o.innerHTML=y,o;let N=o.firstChild,me=null,ye=null,be=null,oe=An(t).next().value;if(s&&oe!==void 0&&oe.key!==void 0&&oe.key!==""){me=new Set,ye=Is(e),be=Is(t);for(let g of An(t))N=Su(N,g,o,r,be,ye,me)}else for(let g of An(t))r.unshift({prev:N,next:g,parent:o}),N=N?.nextSibling;for(;N;){let g=N.nextSibling;o.removeChild(N),N=g}return o}var zt=new WeakMap;function Ft(e){let t=e.currentTarget;if(!zt.has(t)){t.removeEventListener(e.type,Ft);return}let n=zt.get(t);if(!n.has(e.type)){t.removeEventListener(e.type,Ft);return}n.get(e.type)(e)}function Eu(e){let t=e.currentTarget,n=t.getAttribute(`data-lustre-on-${e.type}`),r=JSON.parse(t.getAttribute("data-lustre-data")||"{}"),i=JSON.parse(t.getAttribute("data-lustre-include")||"[]");switch(e.type){case"input":case"change":i.push("target.value");break}return{tag:n,data:i.reduce((s,o)=>{let u=o.split(".");for(let c=0,f=s,m=e;c<u.length;c++)c===u.length-1?f[u[c]]=m[u[c]]:(f[u[c]]??={},m=m[u[c]],f=f[u[c]]);return s},{data:r})}}function Is(e){let t=new Map;if(e)for(let n of An(e)){let r=n?.key||n?.getAttribute?.("data-lustre-key");r&&t.set(r,n)}return t}function Su(e,t,n,r,i,s,o){for(;e&&!i.has(e.getAttribute("data-lustre-key"));){let c=e.nextSibling;n.removeChild(e),e=c}if(s.size===0)return r.unshift({prev:e,next:t,parent:n}),e=e?.nextSibling,e;if(o.has(t.key))return console.warn(`Duplicate key found in Lustre vnode: ${t.key}`),r.unshift({prev:null,next:t,parent:n}),e;o.add(t.key);let u=s.get(t.key);if(!u&&!e)return r.unshift({prev:null,next:t,parent:n}),e;if(!u&&e!==null){let c=document.createTextNode("");return n.insertBefore(c,e),r.unshift({prev:c,next:t,parent:n}),e}return!u||u===e?(r.unshift({prev:e,next:t,parent:n}),e=e?.nextSibling,e):(n.insertBefore(u,e),r.unshift({prev:u,next:t,parent:n}),e)}function*An(e){for(let t of e.children)yield*vn(t)}function*vn(e){if(e.elements!==void 0)for(let t of e.elements)yield*vn(t);else e.subtree!==void 0?yield*vn(e.subtree()):yield e}var Wr=class e{static start({init:t,update:n,view:r},i,s){if(!Vr())return new d(new qt);let o=i instanceof HTMLElement?i:document.querySelector(i);if(!o)return new d(new Ln(i));let u=new e(o,t(s),n,r);return new p(c=>u.send(c))}constructor(t,[n,r],i,s){this.root=t,this.#e=n,this.#s=i,this.#n=s,this.#t=window.requestAnimationFrame(()=>this.#r(r.all.toArray(),!0))}root;send(t){if(t instanceof Mt){if(t[0]instanceof kn){this.#t=window.cancelAnimationFrame(this.#t),this.#i=[],this.#e=t[0][0];let n=this.#n(this.#e),r=(s,o=!1)=>u=>{let c=s(u);c instanceof p&&this.send(new _e(c[0],o))},i=this.root.firstChild??this.root.appendChild(document.createTextNode(""));Jr(i,n,r)}}else if(t instanceof _e){let n=t[0],r=t[1]??!1;this.#i.push(n),r?(this.#t=window.cancelAnimationFrame(this.#t),this.#r()):this.#t||(this.#t=window.requestAnimationFrame(()=>this.#r()))}else if(t instanceof Nt){let n=t[0],r=t[1];this.root.dispatchEvent(new CustomEvent(n,{detail:r,bubbles:!0,composed:!0}))}else if(t instanceof Pt)for(this.#t=window.cancelAnimationFrame(this.#t),this.#e=null,this.#s=null,this.#n=null,this.#i=null;this.root.firstChild;)this.root.firstChild.remove()}#e;#s;#n;#i=[];#t;#r(t=[],n=!1){if(this.#t=void 0,!this.#o(t,n))return;let r=this.#n(this.#e),i=(o,u=!1)=>c=>{let f=o(c);f instanceof p&&this.send(new _e(f[0],u))},s=this.root.firstChild??this.root.appendChild(document.createTextNode(""));Jr(s,r,i)}#o(t=[],n=!1){for(;this.#i.length>0;){let r=this.#i.shift(),[i,s]=this.#s(this.#e,r);n||=this.#e!==i,t=t.concat(s.all.toArray()),this.#e=i}for(;t.length>0;)t.shift()({dispatch:u=>this.send(new _e(u)),emit:(u,c)=>this.root.dispatchEvent(new CustomEvent(u,{detail:c,bubbles:!0,composed:!0})),select:()=>{}});return this.#i.length>0?this.#o(t,n):n}},Ds=Wr.start;var Kr=class e{static start({init:t,update:n,view:r,on_attribute_change:i},s){let o=new e(t(s),n,r,i);return new p(u=>o.send(u))}constructor([t,n],r,i,s){this.#e=t,this.#s=r,this.#i=i,this.#t=i(t),this.#u=s,this.#r=new Map,this.#o=Ts(this.#t),this.#l(n.all.toArray())}send(t){if(t instanceof xn){for(let n of t[0]){let r=this.#u.get(n[0]);if(!r)continue;let i=r(n[1]);i instanceof d||this.#n.push(i)}this.#l()}else if(t instanceof wn)this.#n=this.#n.concat(t[0].toArray()),this.#l(t[1].all.toArray());else if(!(t instanceof Mt))if(t instanceof _e)this.#n.push(t[0]),this.#l();else if(t instanceof Nt){let n=new $n(t[0],t[1]);for(let[r,i]of this.#r)i(n)}else if(t instanceof gn){let n=this.#o.get(t[0]);if(!n)return;let r=n(t[1]);if(r instanceof d)return;this.#n.push(r[0]),this.#l()}else if(t instanceof yn){let n=ir(this.#u),r=new hn(n,this.#t);this.#r=this.#r.set(t[0],t[1]),t[1](r)}else t instanceof bn&&(this.#r=this.#r.delete(t[0]))}#e;#s;#n;#i;#t;#r;#o;#u;#l(t=[]){if(!this.#a(!1,t))return;let n=this.#i(this.#e),r=elements(this.#t,n);if(!qs(r)){let i=new mn(r);for(let[s,o]of this.#r)o(i)}this.#t=n,this.#o=r.handlers}#a(t=!1,n=[]){for(;this.#n.length>0;){let r=this.#n.shift(),[i,s]=this.#s(this.#e,r);t||=this.#e!==i,n=n.concat(s.all.toArray()),this.#e=i}for(;n.length>0;)n.shift()({dispatch:u=>this.send(new _e(u)),emit:(u,c)=>this.root.dispatchEvent(new CustomEvent(u,{detail:c,bubbles:!0,composed:!0})),select:()=>{}});return this.#n.length>0?this.#a(t,n):t}},Tu=Kr.start,Vr=()=>globalThis.window&&window.document;var Yr=class extends a{constructor(t,n,r,i){super(),this.init=t,this.update=n,this.view=r,this.on_attribute_change=i}};var Ln=class extends a{constructor(t){super(),this.selector=t}},qt=class extends a{};function Bs(e,t,n){return new Yr(e,t,n,new h)}function Gs(e,t,n){return xt(!Vr(),new d(new qt),()=>Ds(e,t,n))}function w(e){return zs(e)}function A(e,t){return ut("div",e,t)}function Zr(e,t){return ut("a",e,t)}function C(e,t){return ut("button",e,t)}function Rs(e){return ut("input",e,l([]))}function Us(e,t){return Cs(e,t)}function S(e){return Us("click",t=>new p(e))}function Mu(e){let t=e;return O("target",O("value",fe))(t)}function Hs(e){return Us("input",t=>{let n=Mu(t);return F(n,e)})}function Xr(e,t){return globalThis.setTimeout(t,e)}var It=class extends a{constructor(t,n,r,i){super(),this.id=t,this.name=n,this.rounds_total=r,this.rounds_remaining=i}};function Qr(e,t,n){return new It(e,t,n,n)}function Dt(e){return e.withFields({rounds_remaining:qe(0,e.rounds_remaining-1)})}function Js(e){return e.rounds_remaining===0?e.withFields({rounds_remaining:e.rounds_total}):e.withFields({rounds_remaining:qe(0,e.rounds_remaining-1)})}function ei(e){let t=e.rounds_remaining+1;return e.withFields({rounds_total:qe(e.rounds_total,t),rounds_remaining:t})}function Ws(e){return e.rounds_remaining}function Ks(e){return e.rounds_total}function Vs(e){return e.rounds_remaining<=0}function On(e,t){return L(e,n=>n.id===t.id?t:n)}var ge=class extends a{constructor(t,n,r){super(),this.name=t,this.expires_at=n,this.last_tick=r}},Ee=class extends a{constructor(t,n){super(),this.name=t,this.remaining=n}},Se=class extends a{constructor(t,n){super(),this.name=t,this.duration=n}},at=class extends a{constructor(t,n){super(),this.name=t,this.expiration=n}},Te=class extends a{constructor(t,n){super(),this.name=t,this.remaining=n}},je=class extends a{constructor(t,n){super(),this.name=t,this.remaining=n}},ct=class extends a{constructor(t,n){super(),this.name=t,this.expiration_unix=n}};function Ys(e,t){return new Se(e,t)}function Zs(e){if(e instanceof Te){let t=e.name,n=e.remaining;return new Ee(t,un(n))}else if(e instanceof je){let t=e.name,n=e.remaining;return new Se(t,un(n))}else{let t=e.name,n=e.expiration_unix;return new at(t,ms(n))}}function Xs(e){if(e instanceof Ee){let t=e.name,n=e.remaining;return new Te(t,an(n,new re))}else if(e instanceof Se){let t=e.name,n=e.duration;return new je(t,an(n,new re))}else if(e instanceof at){let t=e.name,n=e.expiration;return new ct(t,zr(n))}else{let t=e.name,n=e.expires_at;return new ct(t,zr(n))}}function Qs(e){return!(e instanceof Ee)}function eo(e,t){if(t instanceof Se){let n=t.name,r=t.duration,i=hs(e,r);return new ge(n,i,e)}else if(t instanceof at){let n=t.name,r=t.expiration;return new ge(n,r,e)}else if(t instanceof ge){let n=t.name,r=t.expires_at;return new ge(n,r,e)}else return t}function to(e){return e.name}function ft(e){if(e instanceof ge){let t=e.expires_at,n=e.last_tick;return!($s(n,t)instanceof D)}else return!1}function pt(e){return e instanceof Ee}function no(e){if(e instanceof ge){let t=e.name,n=e.expires_at,r=e.last_tick;return new Ee(t,cn(n,r))}else return e}function ro(e){if(e instanceof Ee){let t=e.name,n=e.remaining;return new Se(t,n)}else return e}function zu(e){return q(e[0])+(()=>{let t=e[1];return t instanceof re?"s":t instanceof Be?"m":t instanceof Ge?"h":t instanceof Re?"d":t instanceof Ue?"mo":t instanceof He?"y":t instanceof Ie?"us":t instanceof De?"ms":"w"})()}function En(e){let n=an(e,new re),r=un(n),i=Nr(r),s=ki(i),o=Ti(s,[0,new re]);return zu(o)}function io(e){if(e instanceof Se){let t=e.duration;return En(t)+"..."}else{if(e instanceof at)return"...";if(e instanceof ge){let t=e.expires_at,n=e.last_tick;if(ft(e))return"Expired "+(()=>{let i=cn(n,t);return En(i)})()+" ago";{let i=cn(t,n);return En(i)}}else{let t=e.remaining;return"Paused at "+En(t)}}}var Gt=class extends a{constructor(t,n,r,i,s,o){super(),this.light_timer=t,this.players=n,this.turn=r,this.gm_round_timers=i,this.risk_level=s,this.random_encounter_timer=o}},dt=class extends a{constructor(t){super(),this[0]=t}},Rt=class extends a{constructor(t,n,r,i,s,o){super(),this.id=t,this.name=n,this.focusing=r,this.light_bearer=i,this.dying=s,this.round_timers=o}},se=class extends a{constructor(t){super(),this.player_id=t}},Q=class extends a{},ee=class extends a{},Ce=class extends a{},Ut=class extends a{};function jn(e){return e[0]}function so(e){return e instanceof ee?"Unsafe":e instanceof Ce?"Risky":"Deadly"}function oo(e){return e==="Unsafe"?new _(new ee):e==="Risky"?new _(new Ce):e==="Deadly"?new _(new Ut):new h}function Fu(e){return new Rt((()=>{let t=e.players,n=L(t,s=>jn(s.id)),r=J(n,0,qe),i=jr(r,1);return new dt(i)})(),"Player "+q(bi(e.players)+1),!1,!1,!1,l([]))}function Bt(e){let t=ue(e.players,l([Fu(e)]));return e.withFields({players:t})}function qu(){return Ys("Light",os(1))}function Tn(e){return e.withFields({light_timer:new _(qu())})}function lo(e){return e.withFields({light_timer:new h,players:(()=>{let t=e.players;return L(t,n=>n.withFields({light_bearer:!1}))})()})}function uo(e,t){let n=e.light_timer;if(n instanceof h)return e;{let r=n[0],i=eo(t,r);return e.withFields({light_timer:new _(i),players:(()=>{if(ft(i)){let o=e.players;return L(o,u=>u.withFields({light_bearer:!1}))}else return e.players})()})}}function Cn(e){let t=e.light_timer,n=wt(t,Qs);return Xe(n,!1)}function ao(e){let t=e.light_timer,n=(()=>{let r=e.light_timer,i=wt(r,pt);return Xe(i,!0)})();if(t instanceof h)return e;if(t instanceof _&&n){let r=t[0];return e.withFields({light_timer:new _(ro(r))})}else{let r=t[0];return e.withFields({light_timer:new _(no(r))})}}function Iu(e,t,n){return e.withFields({players:L(e.players,r=>x(r.id,t)?n(r):r)})}function Mn(e,t){return e.withFields({players:L(e.players,n=>x(n.id,t.id)?t:n)})}function co(e,t){let n=(()=>{let r=e.players;return Zt(r,i=>x(i.id,t))})();if(n.isOk()){let r=n[0],i=!r.light_bearer,s=(()=>{let o=(()=>{let u=e.light_timer;return wt(u,ft)})();return i&&o instanceof h||i&&o instanceof _&&o[0]?Tn(e):e})();return Mn(s,r.withFields({light_bearer:i}))}else return e}function fo(e){let t=(()=>{let r=e.turn;if(r instanceof Q){let i=e.players;if(i.atLeastLength(1)){let s=i.head;return new se(s.id)}else return new Q}else{let i=r.player_id,s=Li(e.players,o=>!x(o.id,i));if(s.atLeastLength(2)){let o=s.tail.head;return new se(o.id)}else return new Q}})();return(()=>{if(t instanceof Q)return e.withFields({gm_round_timers:L(e.gm_round_timers,Dt),random_encounter_timer:Js(e.random_encounter_timer)});{let r=t.player_id;return Iu(e,r,i=>i.withFields({round_timers:L(i.round_timers,Dt)}))}})().withFields({turn:t})}function po(e,t){return e.withFields({turn:t})}function _o(e,t){return Qr((()=>{let n=e.players,r=vi(n,u=>u.round_timers),i=ue(r,e.gm_round_timers),s=L(i,u=>u.id),o=J(s,0,qe);return jr(o,1)})(),"",t)}function ni(e,t,n){return Mn(e,t.withFields({round_timers:n(t.round_timers)}))}function mo(e,t,n){return ni(e,t,r=>$(_o(e,n),r))}function $o(e,t,n){return ni(e,t,r=>Pe(r,i=>i.id!==n.id))}function ho(e,t,n,r){return ni(e,t,i=>On(i,r(n)))}function xo(e,t,n){return ho(e,t,n,Dt)}function wo(e,t,n){return ho(e,t,n,ei)}function go(e,t){return e.withFields({gm_round_timers:$(_o(e,t),e.gm_round_timers)})}function yo(e,t){return e.withFields({gm_round_timers:Pe(e.gm_round_timers,n=>n.id!==t.id)})}function bo(e,t){return e.withFields({gm_round_timers:On(e.gm_round_timers,Dt(t))})}function ko(e,t){return e.withFields({gm_round_timers:On(e.gm_round_timers,ei(t))})}function Ao(e){return Qr(0,"Random Encounter",e instanceof ee?2:e instanceof Ce?1:0)}function vo(){let e=new Gt(new h,l([]),new Q,l([]),new ee,Ao(new ee)),t=Bt(e),n=Bt(t);return Bt(n)}function Lo(e,t){return e.withFields({risk_level:t,random_encounter_timer:Ao(t)})}function Oo(e,t,n){return r=>{let i=r,s=mr(e,t)(i);return F(s,o=>Xe(o,n))}}function Du(e){return tn(l([O("player_id",t=>{let r=he(t),i=F(r,s=>new dt(s));return F(i,s=>new se(s))}),O("gm",t=>new p(new Q))]))(e)}function Bu(e){let t=mr("remaining",he)(e),n=(()=>{let r=O("is_paused",tt)(e);if(r.isOk()&&r[0]&&t.isOk()&&t[0]instanceof _){let i=t[0][0];return rn((s,o)=>new Te(s,o),O("name",fe),s=>new p(i))(e)}else if(r.isOk()&&!r[0]&&t.isOk()&&t[0]instanceof _){let i=t[0][0];return rn((s,o)=>new je(s,o),O("name",fe),s=>new p(i))(e)}else{if(r.isOk()&&!r[0])return rn((i,s)=>new ct(i,s),O("name",fe),O("expiration_unix",he))(e);if(r.isOk()&&r[0]&&t.isOk()&&t[0]instanceof h)return new d(l([new ke("field 'remaining' for paused timer","no 'remaining' field",l(["remaining"]))]));if(t.isOk()){let i=r[0];return new d(i)}else{let i=t[0];return new d(i)}}})();return F(n,Zs)}function ii(e){return qi((t,n,r,i)=>new It(t,n,r,i),O("id",he),O("name",fe),O("rounds_total",he),O("rounds_remaining",he))(e)}function Gu(e){return $r((t,n,r,i,s,o)=>new Rt(t,n,r,i,s,o),O("id",t=>{let r=he(t);return F(r,i=>new dt(i))}),O("name",fe),O("focusing",tt),O("light_bearer",tt),O("dying",tt),O("round_timers",nn(ii)))(e)}function Ru(e){let n=fe(e),r=F(n,oo);return F(r,i=>Xe(i,new ee))}function Eo(e){let t=$r((n,r,i,s,o,u)=>new Gt(n,r,i,s,o,u),Oo("light_timer",Fi(Bu),new h),O("players",nn(Gu)),Oo("turn",Du,new Q),O("gm_round_timers",nn(ii)),O("risk_level",Ru),O("random_encounter_timer",ii));return As(e,t)}function Hu(e){if(e instanceof se){let t=e.player_id;return Le(l([["player_id",(()=>{let r=jn(t);return ie(r)})()]]))}else return Le(l([["gm",We(!0)]]))}function Ju(e){let n=so(e);return Je(n)}function Wu(e){let t=Xs(e);return Le(l([["name",(()=>{let r=to(e);return Je(r)})()],["is_paused",(()=>{let r=pt(e);return We(r)})()],(()=>{if(t instanceof Te){let n=t.remaining;return["remaining",ie(n)]}else if(t instanceof je){let n=t.remaining;return["remaining",ie(n)]}else{let n=t.expiration_unix;return["expiration_unix",ie(n)]}})()]))}function si(e){return Le(l([["id",(()=>{let t=e.id;return ie(t)})()],["name",(()=>{let t=e.name;return Je(t)})()],["rounds_total",(()=>{let t=e.rounds_total;return ie(t)})()],["rounds_remaining",(()=>{let t=e.rounds_remaining;return ie(t)})()]]))}function Ku(e){return Le(l([["id",(()=>{let t=e.id,n=jn(t);return ie(n)})()],["name",(()=>{let t=e.name;return Je(t)})()],["focusing",(()=>{let t=e.focusing;return We(t)})()],["light_bearer",(()=>{let t=e.light_bearer;return We(t)})()],["dying",(()=>{let t=e.dying;return We(t)})()],["round_timers",(()=>{let t=e.round_timers;return St(t,si)})()]]))}function Vu(e){return Le(l([["light_timer",(()=>{let t=e.light_timer;return Ls(t,Wu)})()],["players",(()=>{let t=e.players;return St(t,Ku)})()],["turn",(()=>{let t=e.turn;return Hu(t)})()],["gm_round_timers",(()=>{let t=e.gm_round_timers;return St(t,si)})()],["risk_level",Ju(e.risk_level)],["random_encounter_timer",si(e.random_encounter_timer)]]))}function So(e){let n=Vu(e);return vs(n)}function oi(){try{return globalThis.Storage&&globalThis.localStorage instanceof globalThis.Storage?new p(globalThis.localStorage):new d(null)}catch{return new d(null)}}function li(e,t){return Zu(e.getItem(t))}function ui(e,t,n){try{return e.setItem(t,n),new p(null)}catch{return new d(null)}}function Zu(e){return e!==null?new p(e):new d(null)}function To(){let e=oi();return ne(e,t=>"Local storage not available")}function Qu(e,t){return W(To(),n=>{let r=ui(n,t,e);return ne(r,i=>"Storage full?")})}function jo(e,t,n){return st(r=>{let i=Qu(e,t),s=n(i);return r(s)})}function ea(e){return W(To(),t=>{let n=li(t,e);return ne(n,r=>e+" not found")})}function Co(e,t){return st(n=>{let r=ea(e),i=t(r);return n(i)})}var Nn=class extends a{constructor(t,n){super(),this.game=t,this.editing=n}},Ht=class extends a{constructor(t){super(),this[0]=t}},Pn=class extends a{},zn=class extends a{constructor(t,n){super(),this[0]=t,this[1]=n}},Fn=class extends a{constructor(t){super(),this[0]=t}},qn=class extends a{},In=class extends a{constructor(t){super(),this[0]=t}},Dn=class extends a{},Bn=class extends a{constructor(t){super(),this[0]=t}},Gn=class extends a{constructor(t){super(),this[0]=t}},Rn=class extends a{constructor(t){super(),this[0]=t}},Jt=class extends a{},Un=class extends a{},Hn=class extends a{},Jn=class extends a{constructor(t,n){super(),this[0]=t,this[1]=n}},Wn=class extends a{constructor(t,n){super(),this[0]=t,this[1]=n}},Kn=class extends a{constructor(t,n){super(),this[0]=t,this[1]=n}},Vn=class extends a{constructor(t,n){super(),this[0]=t,this[1]=n}},Yn=class extends a{constructor(t){super(),this[0]=t}},Zn=class extends a{constructor(t){super(),this[0]=t}},Xn=class extends a{constructor(t){super(),this[0]=t}},Qn=class extends a{constructor(t){super(),this[0]=t}},pi=class extends a{constructor(t){super(),this[0]=t}},er=class extends a{constructor(t){super(),this[0]=t}},tr=class extends a{constructor(t){super(),this[0]=t}},nr=class extends a{constructor(t,n,r,i){super(),this.add=t,this.inc=n,this.dec=r,this.remove=i}};function No(e,t){return e.withFields({game:t(e.game)})}function ai(e,t){return t.withFields({game:Mn(t.game,e)})}function na(){return st(e=>{Xr(250,()=>e(new Ht(Fr())))})}function Po(){return st(e=>e(new Ht(Fr())))}function ra(e,t){return Cn(t)&&!Cn(e)?Po():we()}function ia(e){return e instanceof ee?"Unsafe":e instanceof Ce?"Risky":"Deadly"}function ci(e,t){return C(l([S(new pi(e)),k(x(t.risk_level,e)?"selected":"unselected")]),l([w(ia(e))]))}function fi(e,t){let n=Ws(e.random_encounter_timer),r=Ks(e.random_encounter_timer),i=n===t,s=r<t;return i?"current":!i&&s?"disabled":"just-whatever"}function sa(e){let t=e.game.light_timer;if(t instanceof h)return A(l([X("light-timer")]),l([C(l([S(new Jt)]),l([w("Start Light Timer")]))]));{let n=t[0];return A(l([X("light-timer"),k(ft(n)?"expired":"running")]),l([A(l([k("button-row")]),l([C(l([S(new Un)]),l([w("Clear")])),C(l([S(new Hn)]),l([w(pt(n)?"Resume":"Pause")])),C(l([S(new Jt)]),l([w("Restart")]))])),A(l([k("description")]),l([A(l([]),l([w(io(n))]))]))]))}}function oa(e,t){return A(l([k("timer"),k(Vs(t)?"expired":"running")]),l([A(l([k("description")]),l([A(l([]),l([w((()=>{let n=t.rounds_remaining;return q(n)})()),w(" / "),w((()=>{let n=t.rounds_total;return q(n)})())]))])),A(l([k("button-row")]),l([C(l([S(e.inc(t)),Oe("add 1 round")]),l([w("+")])),C(l([S(e.dec(t)),Oe("subtract 1 round")]),l([w("-")])),C(l([S(e.remove(t)),Oe("remove timer")]),l([w("X")]))]))]))}function zo(e,t){return A(l([k("round-timers")]),$(A(l([k("button-row")]),l([C(l([S(e.add(1))]),l([w("\u23F2\uFE0F1")])),C(l([S(e.add(5))]),l([w("\u23F2\uFE0F5")])),C(l([S(e.add(10))]),l([w("\u23F2\uFE0F10")]))])),L(t,r=>oa(e,r))))}function Mo(e){let t=e.game;return L(t.players,n=>{let r=l(["player"]),i=(()=>{let c=t.turn;if(c instanceof se&&x(c.player_id,n.id)){let f=c.player_id;return $("current-turn",r)}else return r})(),s=n.focusing?$("focusing",i):i,o=n.light_bearer?$("light-bearer",s):s,u=n.dying?$("dying",o):o;return A(L(u,k),l([A(l([k("name")]),l([e.editing?Rs(l([Ns("text"),Ps(n.name),Hs(f=>new zn(n,f))])):A(l([S(new In(new se(n.id))),Ms(l([["cursor","pointer"]])),Oe("Jump current turn")]),l([w(n.name)]))])),A(l([k("button-row"),k("primary-toggles")]),l([C(l([k("light-bearer"),Oe(n.light_bearer?"Light-Bearer":"Not carrying a light"),S(new Bn(n))]),l([w("\u{1F525}")])),C(l([k("focusing"),Oe(n.focusing?"Focusing":"Not focusing"),S(new Gn(n))]),l([w("\u{1F4AD}")])),C(l([k("dying"),Oe(n.dying?"Dying":"Not dying"),S(new Rn(n))]),l([w("\u{1F480}")]))])),zo(new nr(c=>new Jn(n,c),c=>new Vn(n,c),c=>new Kn(n,c),c=>new Wn(n,c)),n.round_timers),e.editing?C(l([S(new Fn(n))]),l([w("Remove")])):w("")]))})}function la(e){let t=e.game,n=t.turn instanceof Q?l([k("current-turn")]):l([]);return A($(X("gm-bar"),n),l([A(l([X("random-encounter-timer")]),l([A(l([k("button-row")]),l([ci(new ee,t),ci(new Ce,t),ci(new Ut,t)])),A(l([k("indicator")]),l([A(l([k("item"),k(fi(t,2))]),l([w("\u25CF")])),A(l([k("item"),k(fi(t,1))]),l([w("\u25CF")])),A(l([X("random-encounter-now"),k("item"),k(fi(t,0))]),l([w("\u{1F3B2}")]))]))])),zo(new nr(r=>new Yn(r),r=>new Qn(r),r=>new Xn(r),r=>new Zn(r)),t.gm_round_timers),sa(e),A(l([X("big-buttons")]),l([C(l([X("toggle-edit"),S(new Dn)]),l([w("Toggle Editing")])),C(l([X("next-turn"),S(new qn)]),l([w("Next Turn")]))]))]))}function ua(){return A(l([X("footer")]),l([w("Made with \u{1FA78} by John D. Hume, "),Zr(l([Rr("https://www.duelinmarkers.com/")]),l([w("duelinmarkers.com")])),w(", "),Zr(l([Rr("https://hachyderm.io/@duelinmarkers")]),l([w("hachyderm.io/@duelinmarkers")])),w(".")]))}function aa(e){return A(l([X("main")]),l([A(l([X("players")]),e.editing?ue(Mo(e),l([C(l([S(new Pn)]),l([w("Add Player")]))])):Mo(e)),la(e),ua()]))}var Fo="shadowboard_game:First Table";function ca(e){return[new Nn(vo(),!0),Co(Fo,n=>new tr(n))]}function qo(e){let t=e.game,n=So(t);return jo(n,Fo,r=>new er(r))}function P(e,t){let n=No(e,t);return[n,Os(l([qo(n),ra(e.game,n.game)]))]}function fa(e,t){if(t instanceof er){let n=t[0],r=ne(n,qr);return[e,we()]}else if(t instanceof tr){let n=t[0],r=W(n,i=>{let o=Eo(i);return ne(o,At)});if(r.isOk()){let i=r[0];return ws("Loaded game"),[new Nn(i,!1),Po()]}else{let i=qr(r);return[e,we()]}}else if(t instanceof Ht){let n=t[0],r=No(e,s=>uo(s,n));return x(e.game,r.game)&&!Cn(e.game)?[e,we()]:[r,na()]}else{if(t instanceof Dn)return[e.withFields({editing:!e.editing}),qo(e)];if(t instanceof Jt)return P(e,Tn);if(t instanceof Un)return P(e,lo);if(t instanceof Hn)return P(e,ao);if(t instanceof Pn)return P(e,Bt);if(t instanceof Fn){let n=t[0];return P(e,r=>r.withFields({players:Pe(r.players,i=>!x(i.id,n.id))}))}else if(t instanceof zn){let n=t[0],r=t[1];return[ai(n.withFields({name:r}),e),we()]}else if(t instanceof Bn){let n=t[0];return P(e,r=>co(r,n.id))}else if(t instanceof Gn){let n=t[0];return[ai(n.withFields({focusing:!n.focusing}),e),we()]}else if(t instanceof Rn){let n=t[0];return[ai(n.withFields({light_bearer:!1,focusing:!1,dying:!n.dying}),e),we()]}else if(t instanceof Jn){let n=t[0],r=t[1];return P(e,i=>mo(i,n,r))}else if(t instanceof Yn){let n=t[0];return P(e,r=>go(r,n))}else{if(t instanceof qn)return P(e,fo);if(t instanceof In){let n=t[0];return P(e,r=>po(r,n))}else if(t instanceof Wn){let n=t[0],r=t[1];return P(e,i=>$o(i,n,r))}else if(t instanceof Kn){let n=t[0],r=t[1];return P(e,i=>xo(i,n,r))}else if(t instanceof Vn){let n=t[0],r=t[1];return P(e,i=>wo(i,n,r))}else if(t instanceof Zn){let n=t[0];return P(e,r=>yo(r,n))}else if(t instanceof Xn){let n=t[0];return P(e,r=>bo(r,n))}else if(t instanceof Qn){let n=t[0];return P(e,r=>ko(r,n))}else{let n=t[0];return P(e,r=>Lo(r,n))}}}}function Io(){let e=Bs(ca,fa,aa),t=Gs(e,"#app",void 0);if(!t.isOk())throw Ze("let_assert","app",29,"main","Pattern match failed, no pattern matched the value.",{value:t})}Io();
