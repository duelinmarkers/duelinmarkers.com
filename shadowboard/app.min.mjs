var c=class{withFields(t){let n=Object.keys(this).map(r=>r in t?t[r]:this[r]);return new this.constructor(...n)}},z=class{static fromArray(t,n){let r=n||new Rt;for(let i=t.length-1;i>=0;--i)r=new _t(t[i],r);return r}[Symbol.iterator](){return new Xn(this)}toArray(){return[...this]}atLeastLength(t){for(let n of this){if(t<=0)return!0;t--}return t<=0}hasLength(t){for(let n of this){if(t<=0)return!1;t--}return t===0}countLength(){let t=0;for(let n of this)t++;return t}};function $(e,t){return new _t(e,t)}function l(e,t){return z.fromArray(e,t)}var Xn=class{#e;constructor(t){this.#e=t}next(){if(this.#e instanceof Rt)return{done:!0};{let{head:t,tail:n}=this.#e;return this.#e=n,{value:t,done:!1}}}},Rt=class extends z{},_t=class extends z{constructor(t,n){super(),this.head=t,this.tail=n}},mt=class e{constructor(t){if(!(t instanceof Uint8Array))throw"BitArray can only be constructed from a Uint8Array";this.buffer=t}get length(){return this.buffer.length}byteAt(t){return this.buffer[t]}floatFromSlice(t,n,r){return No(this.buffer,t,n,r)}intFromSlice(t,n,r,i){return Mo(this.buffer,t,n,r,i)}binaryFromSlice(t,n){return new e(this.buffer.slice(t,n))}sliceAfter(t){return new e(this.buffer.slice(t))}},Ut=class{constructor(t){this.value=t}};function Mo(e,t,n,r,i){let s=0;if(r)for(let o=t;o<n;o++)s=s*256+e[o];else for(let o=n-1;o>=t;o--)s=s*256+e[o];if(i){let u=2**((n-t)*8-1);s>=u&&(s-=u*2)}return s}function No(e,t,n,r){let i=new DataView(e.buffer),s=n-t;if(s===8)return i.getFloat64(t,!r);if(s===4)return i.getFloat32(t,!r);{let o=`Sized floats must be 32-bit or 64-bit on JavaScript, got size of ${s*8} bits`;throw new globalThis.Error(o)}}var Je=class e extends c{static isResult(t){return t instanceof e}},p=class extends Je{constructor(t){super(),this[0]=t}isOk(){return!0}},d=class extends Je{constructor(t){super(),this[0]=t}isOk(){return!1}};function v(e,t){let n=[e,t];for(;n.length;){let r=n.pop(),i=n.pop();if(r===i)continue;if(!ai(r)||!ai(i)||!Go(r,i)||zo(r,i)||Fo(r,i)||qo(r,i)||Io(r,i)||Bo(r,i)||Do(r,i))return!1;let o=Object.getPrototypeOf(r);if(o!==null&&typeof o.equals=="function")try{if(r.equals(i))continue;return!1}catch{}let[u,a]=Po(r);for(let f of u(r))n.push(a(r,f),a(i,f))}return!0}function Po(e){if(e instanceof Map)return[t=>t.keys(),(t,n)=>t.get(n)];{let t=e instanceof globalThis.Error?["message"]:[];return[n=>[...t,...Object.keys(n)],(n,r)=>n[r]]}}function zo(e,t){return e instanceof Date&&(e>t||e<t)}function Fo(e,t){return e.buffer instanceof ArrayBuffer&&e.BYTES_PER_ELEMENT&&!(e.byteLength===t.byteLength&&e.every((n,r)=>n===t[r]))}function qo(e,t){return Array.isArray(e)&&e.length!==t.length}function Io(e,t){return e instanceof Map&&e.size!==t.size}function Bo(e,t){return e instanceof Set&&(e.size!=t.size||[...e].some(n=>!t.has(n)))}function Do(e,t){return e instanceof RegExp&&(e.source!==t.source||e.flags!==t.flags)}function ai(e){return typeof e=="object"&&e!==null}function Go(e,t){return typeof e!="object"&&typeof t!="object"&&(!e||!t)||[Promise,WeakSet,WeakMap,Function].some(r=>e instanceof r)?!1:e.constructor===t.constructor}function We(e,t){return t===0?0:e%t}function Oe(e,t){return Math.trunc(ci(e,t))}function ci(e,t){return t===0?0:e/t}function Ke(e,t,n,r,i,s){let o=new globalThis.Error(i);o.gleam_error=e,o.module=t,o.line=n,o.function=r,o.fn=r;for(let u in s)o[u]=s[u];return o}var I=class extends c{},D=class extends c{},G=class extends c{};function $t(e,t,n){return e?t:n()}var _=class extends c{constructor(t){super(),this[0]=t}},x=class extends c{};function fi(e,t){if(e instanceof _){let n=e[0];return new p(n)}else return new d(t)}function pi(e,t){return e instanceof _?e[0]:t}function Jt(e,t){if(e instanceof _){let n=e[0];return new _(t(n))}else return new x}function Qn(e){return e instanceof _?e[0]:new x}function pe(){return _i()}function ht(e,t,n){return $i(t,n,e)}function Uo(e,t){for(;;){let n=e,r=t;if(n.hasLength(0))return r;{let i=n.head;e=n.tail,t=$(i,r)}}}function Ho(e,t){for(;;){let n=e,r=t;if(n.hasLength(0))return Uo(r,l([]));{let i=n.head;e=n.tail,t=$(i[0],r)}}}function Jo(e){let t=Wt(e);return Ho(t,l([]))}function er(e){return Jo(e)}function Vo(e,t){for(;;){let n=e,r=t;if(n.atLeastLength(1))e=n.tail,t=r+1;else return r}}function xi(e){return Vo(e,0)}function Yo(e,t){for(;;){let n=e,r=t;if(n.hasLength(0))return r;{let i=n.head;e=n.tail,t=$(i,r)}}}function R(e){return Yo(e,l([]))}function wi(e){if(e.hasLength(0))return new d(void 0);{let t=e.head;return new p(t)}}function Zo(e,t,n){for(;;){let r=e,i=t,s=n;if(r.hasLength(0))return R(s);{let o=r.head,u=r.tail,a=i(o)?$(o,s):s;e=u,t=i,n=a}}}function Se(e,t){return Zo(e,t,l([]))}function Xo(e,t,n){for(;;){let r=e,i=t,s=n;if(r.hasLength(0))return R(s);{let o=r.head;e=r.tail,t=i,n=$(i(o),s)}}}function L(e,t){return Xo(e,t,l([]))}function Qo(e,t,n){for(;;){let r=e,i=t,s=n;if(r.hasLength(0))return new p(R(s));{let o=r.head,u=r.tail,a=i(o);if(a.isOk()){let f=a[0];e=u,t=i,n=$(f,s)}else{let f=a[0];return new d(f)}}}}function xt(e,t){return Qo(e,t,l([]))}function tr(e,t){for(;;){let n=e,r=t;if(r<=0)return n;if(n.hasLength(0))return l([]);e=n.tail,t=r-1}}function el(e,t,n){for(;;){let r=e,i=t,s=n;if(i<=0)return R(s);if(r.hasLength(0))return R(s);{let u=r.head;e=r.tail,t=i-1,n=$(u,s)}}}function gi(e,t){return el(e,t,l([]))}function tl(e,t){for(;;){let n=e,r=t;if(n.hasLength(0))return r;{let i=n.head;e=n.tail,t=$(i,r)}}}function de(e,t){return tl(R(e),t)}function nl(e,t){for(;;){let n=e,r=t;if(n.hasLength(0))return r;{let i=n.head;e=n.tail,t=$(i,r)}}}function rl(e,t){for(;;){let n=e,r=t;if(n.hasLength(0))return R(r);{let i=n.head;e=n.tail,t=nl(i,r)}}}function wt(e){return rl(e,l([]))}function yi(e,t){let n=L(e,t);return wt(n)}function te(e,t,n){for(;;){let r=e,i=t,s=n;if(r.hasLength(0))return i;{let o=r.head;e=r.tail,t=s(i,o),n=s}}}function il(e,t,n,r){for(;;){let i=e,s=t,o=n,u=r;if(i.hasLength(0))return s;{let a=i.head;e=i.tail,t=o(s,a,u),n=o,r=u+1}}}function nr(e,t,n){return il(e,t,n,0)}function sl(e,t){for(;;){let n=e,r=t;if(n.hasLength(0))return new d(void 0);{let i=n.head,s=n.tail,o=r(i);if(o.isOk()){let u=o[0];return new p(u)}else e=s,t=r}}}function rr(e,t){return sl(e,n=>{let r=n[0],i=n[1];return v(r,t)?new p(i):new d(void 0)})}function bi(e,t){for(;;){let n=e,r=t;if(n.hasLength(0))return l([]);{let i=n.head,s=n.tail;if(r(i))e=s,t=r;else return $(i,s)}}}function J(e,t){if(e.isOk()){let n=e[0];return new p(t(n))}else{let n=e[0];return new d(n)}}function ne(e,t){if(e.isOk()){let n=e[0];return new p(n)}else{let n=e[0];return new d(t(n))}}function W(e,t){if(e.isOk()){let n=e[0];return t(n)}else{let n=e[0];return new d(n)}}function gt(e,t){return W(e,t)}function Li(e,t){return e.isOk()?e[0]:t}function Kt(e){return or(e)}function Ye(e){return e}function lr(e){return Ci(e)}function Ti(e){let n=Kt(e);return Ye(n)}function Si(e,t,n){let i=sr(e),s=tr(i,t),o=gi(s,n);return Ti(o)}function ji(e,t,n){if(n<0)return"";if(t<0){let s=lr(e)+t;return s<0?"":Si(e,s,n)}else return Si(e,t,n)}function Yt(e,t){return t<0?e:ji(e,t,lr(e)-t)}function yt(e){let t=le(e);return Ye(t)}var Ze=class extends c{constructor(t,n,r){super(),this.expected=t,this.found=n,this.path=r}};function ur(e){return dr(e)}function be(e){return qi(e)}function Xe(e){return Ii(e)}function ml(e){return Bi(e)}function Mi(e){return t=>Di(t,e)}function Ni(e){return t=>{if(e.hasLength(0))return new d(l([new Ze("another type",ur(t),l([]))]));{let n=e.head,r=e.tail,i=n(t);if(i.isOk()){let s=i[0];return new p(s)}else return Ni(r)(t)}}}function V(e){return e.isOk()?l([]):e[0]}function ar(e,t){let n=t,r=Ni(l([_e,s=>J(be(s),F)])),i=(()=>{let s=r(n);if(s.isOk())return s[0];{let o=l(["<",ur(n),">"]),u=Kt(o);return Ye(u)}})();return e.withFields({path:$(i,e.path)})}function Zt(e){return t=>W(ml(t),n=>{let i=xt(n,e);return cr(i,s=>ar(s,"*"))})}function cr(e,t){return ne(e,n=>L(n,t))}function _e(e){return Fi(e)}function O(e,t){return n=>{let r=new Ze("field","nothing",l([]));return W(_r(n,e),i=>{let o=fi(i,l([r])),u=W(o,t);return cr(u,a=>ar(a,e))})}}function Pi(e,t){return n=>W(_r(n,e),r=>{if(r instanceof x)return new p(new x);{let i=r[0],s=t(i),o=J(s,u=>new _(u));return cr(o,u=>ar(u,e))}})}function fr(e,t,n){return r=>{let i=t(r),s=n(r);if(i.isOk()&&s.isOk()){let o=i[0],u=s[0];return new p(e(o,u))}else{let o=i,u=s;return new d(wt(l([V(o),V(u)])))}}}function zi(e,t,n,r,i){return s=>{let o=t(s),u=n(s),a=r(s),f=i(s);if(o.isOk()&&u.isOk()&&a.isOk()&&f.isOk()){let m=o[0],y=u[0],g=a[0],N=f[0];return new p(e(m,y,g,N))}else{let m=o,y=u,g=a,N=f;return new d(wt(l([V(m),V(y),V(g),V(N)])))}}}function pr(e,t,n,r,i,s,o){return u=>{let a=t(u),f=n(u),m=r(u),y=i(u),g=s(u),N=o(u);if(a.isOk()&&f.isOk()&&m.isOk()&&y.isOk()&&g.isOk()&&N.isOk()){let P=a[0],fe=f[0],ge=m[0],ye=y[0],ie=g[0],w=N[0];return new p(e(P,fe,ge,ye,ie,w))}else{let P=a,fe=f,ge=m,ye=y,ie=g,w=N;return new d(wt(l([V(P),V(fe),V(ge),V(ye),V(ie),V(w)])))}}}var Gi=new WeakMap,mr=new DataView(new ArrayBuffer(8)),$r=0;function hr(e){let t=Gi.get(e);if(t!==void 0)return t;let n=$r++;return $r===2147483647&&($r=0),Gi.set(e,n),n}function xr(e,t){return e^t+2654435769+(e<<6)+(e>>2)|0}function gr(e){let t=0,n=e.length;for(let r=0;r<n;r++)t=Math.imul(31,t)+e.charCodeAt(r)|0;return t}function Ri(e){mr.setFloat64(0,e);let t=mr.getInt32(0),n=mr.getInt32(4);return Math.imul(73244475,t>>16^t)^n}function $l(e){return gr(e.toString())}function hl(e){let t=Object.getPrototypeOf(e);if(t!==null&&typeof t.hashCode=="function")try{let r=e.hashCode(e);if(typeof r=="number")return r}catch{}if(e instanceof Promise||e instanceof WeakSet||e instanceof WeakMap)return hr(e);if(e instanceof Date)return Ri(e.getTime());let n=0;if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||e instanceof Uint8Array)for(let r=0;r<e.length;r++)n=Math.imul(31,n)+Y(e[r])|0;else if(e instanceof Set)e.forEach(r=>{n=n+Y(r)|0});else if(e instanceof Map)e.forEach((r,i)=>{n=n+xr(Y(r),Y(i))|0});else{let r=Object.keys(e);for(let i=0;i<r.length;i++){let s=r[i],o=e[s];n=n+xr(Y(o),gr(s))|0}}return n}function Y(e){if(e===null)return 1108378658;if(e===void 0)return 1108378659;if(e===!0)return 1108378657;if(e===!1)return 1108378656;switch(typeof e){case"number":return Ri(e);case"string":return gr(e);case"bigint":return $l(e);case"object":return hl(e);case"symbol":return hr(e);case"function":return hr(e);default:return 0}}var ae=5,yr=Math.pow(2,ae),xl=yr-1,wl=yr/2,gl=yr/4,q=0,ue=1,H=2,je=3,br={type:H,bitmap:0,array:[]};function bt(e,t){return e>>>t&xl}function en(e,t){return 1<<bt(e,t)}function yl(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function kr(e,t){return yl(e&t-1)}function Z(e,t,n){let r=e.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=e[s];return i[t]=n,i}function bl(e,t,n){let r=e.length,i=new Array(r+1),s=0,o=0;for(;s<t;)i[o++]=e[s++];for(i[o++]=n;s<r;)i[o++]=e[s++];return i}function wr(e,t){let n=e.length,r=new Array(n-1),i=0,s=0;for(;i<t;)r[s++]=e[i++];for(++i;i<n;)r[s++]=e[i++];return r}function Ui(e,t,n,r,i,s){let o=Y(t);if(o===r)return{type:je,hash:o,array:[{type:q,k:t,v:n},{type:q,k:i,v:s}]};let u={val:!1};return kt(Ar(br,e,o,t,n,u),e,r,i,s,u)}function kt(e,t,n,r,i,s){switch(e.type){case ue:return kl(e,t,n,r,i,s);case H:return Ar(e,t,n,r,i,s);case je:return Al(e,t,n,r,i,s)}}function kl(e,t,n,r,i,s){let o=bt(n,t),u=e.array[o];if(u===void 0)return s.val=!0,{type:ue,size:e.size+1,array:Z(e.array,o,{type:q,k:r,v:i})};if(u.type===q)return v(r,u.k)?i===u.v?e:{type:ue,size:e.size,array:Z(e.array,o,{type:q,k:r,v:i})}:(s.val=!0,{type:ue,size:e.size,array:Z(e.array,o,Ui(t+ae,u.k,u.v,n,r,i))});let a=kt(u,t+ae,n,r,i,s);return a===u?e:{type:ue,size:e.size,array:Z(e.array,o,a)}}function Ar(e,t,n,r,i,s){let o=en(n,t),u=kr(e.bitmap,o);if(e.bitmap&o){let a=e.array[u];if(a.type!==q){let m=kt(a,t+ae,n,r,i,s);return m===a?e:{type:H,bitmap:e.bitmap,array:Z(e.array,u,m)}}let f=a.k;return v(r,f)?i===a.v?e:{type:H,bitmap:e.bitmap,array:Z(e.array,u,{type:q,k:r,v:i})}:(s.val=!0,{type:H,bitmap:e.bitmap,array:Z(e.array,u,Ui(t+ae,f,a.v,n,r,i))})}else{let a=e.array.length;if(a>=wl){let f=new Array(32),m=bt(n,t);f[m]=Ar(br,t+ae,n,r,i,s);let y=0,g=e.bitmap;for(let N=0;N<32;N++){if(g&1){let P=e.array[y++];f[N]=P}g=g>>>1}return{type:ue,size:a+1,array:f}}else{let f=bl(e.array,u,{type:q,k:r,v:i});return s.val=!0,{type:H,bitmap:e.bitmap|o,array:f}}}}function Al(e,t,n,r,i,s){if(n===e.hash){let o=vr(e,r);if(o!==-1)return e.array[o].v===i?e:{type:je,hash:n,array:Z(e.array,o,{type:q,k:r,v:i})};let u=e.array.length;return s.val=!0,{type:je,hash:n,array:Z(e.array,u,{type:q,k:r,v:i})}}return kt({type:H,bitmap:en(e.hash,t),array:[e]},t,n,r,i,s)}function vr(e,t){let n=e.array.length;for(let r=0;r<n;r++)if(v(t,e.array[r].k))return r;return-1}function Qt(e,t,n,r){switch(e.type){case ue:return vl(e,t,n,r);case H:return Ll(e,t,n,r);case je:return Ol(e,r)}}function vl(e,t,n,r){let i=bt(n,t),s=e.array[i];if(s!==void 0){if(s.type!==q)return Qt(s,t+ae,n,r);if(v(r,s.k))return s}}function Ll(e,t,n,r){let i=en(n,t);if(!(e.bitmap&i))return;let s=kr(e.bitmap,i),o=e.array[s];if(o.type!==q)return Qt(o,t+ae,n,r);if(v(r,o.k))return o}function Ol(e,t){let n=vr(e,t);if(!(n<0))return e.array[n]}function Lr(e,t,n,r){switch(e.type){case ue:return El(e,t,n,r);case H:return Sl(e,t,n,r);case je:return Tl(e,r)}}function El(e,t,n,r){let i=bt(n,t),s=e.array[i];if(s===void 0)return e;let o;if(s.type===q){if(!v(s.k,r))return e}else if(o=Lr(s,t+ae,n,r),o===s)return e;if(o===void 0){if(e.size<=gl){let u=e.array,a=new Array(e.size-1),f=0,m=0,y=0;for(;f<i;){let g=u[f];g!==void 0&&(a[m]=g,y|=1<<f,++m),++f}for(++f;f<u.length;){let g=u[f];g!==void 0&&(a[m]=g,y|=1<<f,++m),++f}return{type:H,bitmap:y,array:a}}return{type:ue,size:e.size-1,array:Z(e.array,i,o)}}return{type:ue,size:e.size,array:Z(e.array,i,o)}}function Sl(e,t,n,r){let i=en(n,t);if(!(e.bitmap&i))return e;let s=kr(e.bitmap,i),o=e.array[s];if(o.type!==q){let u=Lr(o,t+ae,n,r);return u===o?e:u!==void 0?{type:H,bitmap:e.bitmap,array:Z(e.array,s,u)}:e.bitmap===i?void 0:{type:H,bitmap:e.bitmap^i,array:wr(e.array,s)}}return v(r,o.k)?e.bitmap===i?void 0:{type:H,bitmap:e.bitmap^i,array:wr(e.array,s)}:e}function Tl(e,t){let n=vr(e,t);if(n<0)return e;if(e.array.length!==1)return{type:je,hash:e.hash,array:wr(e.array,n)}}function Hi(e,t){if(e===void 0)return;let n=e.array,r=n.length;for(let i=0;i<r;i++){let s=n[i];if(s!==void 0){if(s.type===q){t(s.v,s.k);continue}Hi(s,t)}}}var ke=class e{static fromObject(t){let n=Object.keys(t),r=e.new();for(let i=0;i<n.length;i++){let s=n[i];r=r.set(s,t[s])}return r}static fromMap(t){let n=e.new();return t.forEach((r,i)=>{n=n.set(i,r)}),n}static new(){return new e(void 0,0)}constructor(t,n){this.root=t,this.size=n}get(t,n){if(this.root===void 0)return n;let r=Qt(this.root,0,Y(t),t);return r===void 0?n:r.v}set(t,n){let r={val:!1},i=this.root===void 0?br:this.root,s=kt(i,0,Y(t),t,n,r);return s===this.root?this:new e(s,r.val?this.size+1:this.size)}delete(t){if(this.root===void 0)return this;let n=Lr(this.root,0,Y(t),t);return n===this.root?this:n===void 0?e.new():new e(n,this.size-1)}has(t){return this.root===void 0?!1:Qt(this.root,0,Y(t),t)!==void 0}entries(){if(this.root===void 0)return[];let t=[];return this.forEach((n,r)=>t.push([r,n])),t}forEach(t){Hi(this.root,t)}hashCode(){let t=0;return this.forEach((n,r)=>{t=t+xr(Y(n),Y(r))|0}),t}equals(t){if(!(t instanceof e)||this.size!==t.size)return!1;let n=!0;return this.forEach((r,i)=>{n=n&&v(t.get(i,!r),r)}),n}};var jl=void 0,Ji={};function Vi(e){return e.toString()}function Ci(e){if(e==="")return 0;let t=Yi(e);if(t){let n=0;for(let r of t)n++;return n}else return e.match(/./gsu).length}function sr(e){let t=Yi(e);return t?z.fromArray(Array.from(t).map(n=>n.segment)):z.fromArray(e.match(/./gsu))}function Yi(e){if(globalThis.Intl&&Intl.Segmenter)return new Intl.Segmenter().segment(e)[Symbol.iterator]()}function or(e){let t="";for(let n of e)t=t+n;return t}var Zi=[" ","	",`
`,"\v","\f","\r","\x85","\u2028","\u2029"].join(""),Dc=new RegExp(`^([${Zi}]*)`,"g"),Gc=new RegExp(`([${Zi}]*)$`,"g");function Xi(e){console.log(e)}function Qi(e){typeof process=="object"&&process.stderr?.write?process.stderr.write(e+`
`):typeof Deno=="object"?Deno.stderr.writeSync(new TextEncoder().encode(e+`
`)):console.log(e)}function _i(){return ke.new()}function Wt(e){return z.fromArray(e.entries())}function mi(e,t){let n=e.get(t,Ji);return n===Ji?new d(jl):new p(n)}function $i(e,t,n){return n.set(e,t)}function dr(e){if(typeof e=="string")return"String";if(typeof e=="boolean")return"Bool";if(e instanceof Je)return"Result";if(e instanceof z)return"List";if(e instanceof mt)return"BitArray";if(e instanceof ke)return"Dict";if(Number.isInteger(e))return"Int";if(Array.isArray(e))return`Tuple of ${e.length} elements`;if(typeof e=="number")return"Float";if(e===null)return"Null";if(e===void 0)return"Nil";{let t=typeof e;return t.charAt(0).toUpperCase()+t.slice(1)}}function At(e,t){return Cl(e,dr(t))}function Cl(e,t){return new d(z.fromArray([new Ze(e,t,z.fromArray([]))]))}function Fi(e){return typeof e=="string"?new p(e):At("String",e)}function qi(e){return Number.isInteger(e)?new p(e):At("Int",e)}function Ii(e){return typeof e=="boolean"?new p(e):At("Bool",e)}function Bi(e){return Array.isArray(e)?new p(z.fromArray(e)):e instanceof z?new p(e):At("List",e)}function Di(e,t){if(e==null||e instanceof x)return new p(new x);e instanceof _&&(e=e[0]);let n=t(e);return n.isOk()?new p(new _(n[0])):n}function _r(e,t){let n=()=>At("Dict",e);if(e instanceof ke||e instanceof WeakMap||e instanceof Map){let r=mi(e,t);return new p(r.isOk()?new _(r[0]):new x)}else return e===null?n():Object.getPrototypeOf(e)==Object.prototype?Wi(e,t,()=>new p(new x)):Wi(e,t,n)}function Wi(e,t,n){try{return t in e?new p(new _(e[t])):n()}catch{return n()}}function le(e){let t=typeof e;if(e===!0)return"True";if(e===!1)return"False";if(e===null)return"//js(null)";if(e===void 0)return"Nil";if(t==="string")return Ml(e);if(t==="bigint"||t==="number")return e.toString();if(Array.isArray(e))return`#(${e.map(le).join(", ")})`;if(e instanceof z)return Fl(e);if(e instanceof Ut)return Il(e);if(e instanceof mt)return ql(e);if(e instanceof c)return zl(e);if(e instanceof ke)return Nl(e);if(e instanceof Set)return`//js(Set(${[...e].map(le).join(", ")}))`;if(e instanceof RegExp)return`//js(${e})`;if(e instanceof Date)return`//js(Date("${e.toISOString()}"))`;if(e instanceof Function){let n=[];for(let r of Array(e.length).keys())n.push(String.fromCharCode(r+97));return`//fn(${n.join(", ")}) { ... }`}return Pl(e)}function Ml(e){let t='"';for(let n=0;n<e.length;n++){let r=e[n];switch(r){case`
`:t+="\\n";break;case"\r":t+="\\r";break;case"	":t+="\\t";break;case"\f":t+="\\f";break;case"\\":t+="\\\\";break;case'"':t+='\\"';break;default:r<" "||r>"~"&&r<"\xA0"?t+="\\u{"+r.charCodeAt(0).toString(16).toUpperCase().padStart(4,"0")+"}":t+=r}}return t+='"',t}function Nl(e){let t="dict.from_list([",n=!0;return e.forEach((r,i)=>{n||(t=t+", "),t=t+"#("+le(i)+", "+le(r)+")",n=!1}),t+"])"}function Pl(e){let t=Object.getPrototypeOf(e)?.constructor?.name||"Object",n=[];for(let s of Object.keys(e))n.push(`${le(s)}: ${le(e[s])}`);let r=n.length?" "+n.join(", ")+" ":"";return`//js(${t==="Object"?"":t+" "}{${r}})`}function zl(e){let t=Object.keys(e).map(n=>{let r=le(e[n]);return isNaN(parseInt(n))?`${n}: ${r}`:r}).join(", ");return t?`${e.constructor.name}(${t})`:e.constructor.name}function Fl(e){return`[${e.toArray().map(le).join(", ")}]`}function ql(e){return`<<${Array.from(e.buffer).join(", ")}>>`}function Il(e){return`//utfcodepoint(${String.fromCodePoint(e.value)})`}function Xt(e){return e>=0?e:e*-1}function F(e){return Vi(e)}function Ce(e,t){return e>t?e:t}function Or(e,t){return e+t}var et=class extends c{constructor(t){super(),this[0]=t}},Me=class extends c{},Ne=class extends c{},re=class extends c{},Pe=class extends c{},ze=class extends c{},Fe=class extends c{},vt=class extends c{},qe=class extends c{},Ie=class extends c{};function me(e,t){return[Oe(e,t),We(e,t)]}var ns=1e3;var Er=1e6;function Sr(e){return new et(e*Er)}var rs=6e7;var Tr=36e8;function is(e){return new et(e*Tr)}var ss=864e8;var os=6048e8;var ls=2592e9;var us=31536e9;function jr(e){let t=e[0],n=Xt(t),r=me(n,us),i=r[0],s=r[1],o=me(s,ls),u=o[0],a=o[1],f=me(a,os),m=f[0],y=f[1],g=me(y,ss),N=g[0],P=g[1],fe=me(P,Tr),ge=fe[0],ye=fe[1],ie=me(ye,rs),w=ie[0],A=ie[1],j=me(A,Er),ee=j[0],pt=j[1],ui=me(pt,ns),So=ui[0],To=ui[1],jo=l([[i,new Ie],[u,new qe],[m,new vt],[N,new Fe],[ge,new ze],[w,new Pe],[ee,new re],[So,new Ne],[To,new Me]]),Co=Se(jo,dt=>dt[0]>0);return L(Co,dt=>t<0?[-1*dt[0],dt[1]]:dt)}var Wl=l([[new Ie,us],[new qe,ls],[new vt,os],[new Fe,ss],[new ze,Tr],[new Pe,rs],[new re,Er],[new Ne,ns],[new Me,1]]);function tn(e,t){let n=rr(Wl,t);if(!n.isOk())throw Ke("let_assert","birl/duration",207,"blur_to","Pattern match failed, no pattern matched the value.",{value:n});let r=n[0],i=e[0],s=me(i,r),o=s[0];return s[1]>=Oe(r*2,3)?o+1:o}function as(){return Date.now()*1e3}function cs(){return Math.floor(globalThis.performance.now()*1e3)}var tt=class extends c{constructor(t,n,r,i){super(),this.wall_time=t,this.offset=n,this.timezone=r,this.monotonic_time=i}};function Mr(e){{let t=e.wall_time;return Oe(t,1e6)}}function ds(e){return new tt(e*1e6,0,new x,new x)}function _s(e,t){let n=e.wall_time,r=e.monotonic_time,i=t.wall_time,s=t.monotonic_time,o=(()=>{if(r instanceof _&&s instanceof _){let y=r[0],g=s[0];return[y,g]}else return[n,i]})(),u=o[0],a=o[1],f=u===a,m=u<a;return f?new D:m?new I:new G}function nn(e,t){let n=e.wall_time,r=e.monotonic_time,i=t.wall_time,s=t.monotonic_time,o=(()=>{if(r instanceof _&&s instanceof _){let f=r[0],m=s[0];return[f,m]}else return[n,i]})(),u=o[0],a=o[1];return new et(u-a)}function ms(e,t){let n=e.wall_time,r=e.offset,i=e.timezone,s=e.monotonic_time,o=t[0];if(s instanceof _){let u=s[0];return new tt(n+o,r,i,new _(u+o))}else return new tt(n+o,r,i,new x)}function $s(){let e=as(),t=cs();return new tt(e,0,new _("Etc/UTC"),new _(t))}function xs(e){return Xi(e)}function Nr(e){let n=yt(e);return Qi(n),e}function Pr(e){return JSON.stringify(e)}function ws(e){return Object.fromEntries(e)}function gs(e){return e.toArray()}function ys(){return null}function bs(e){try{let t=JSON.parse(e);return new p(t)}catch(t){return new d(Zl(t,e))}}function Zl(e,t){return Xl(e)?new sn:Ql(e,t)}function Xl(e){return/((unexpected (end|eof))|(end of data)|(unterminated string)|(json( parse error|\.parse)\: expected '(\:|\}|\])'))/i.test(e.message)}function Ql(e,t){let n=[eu,tu,ru,nu];for(let r of n){let i=r(e,t);if(i)return i}return new Ae("",0)}function eu(e){let n=/unexpected token '(.)', ".+" is not valid JSON/i.exec(e.message);if(!n)return null;let r=rn(n[1]);return new Ae(r,-1)}function tu(e){let n=/unexpected token (.) in JSON at position (\d+)/i.exec(e.message);if(!n)return null;let r=rn(n[1]),i=Number(n[2]);return new Ae(r,i)}function nu(e,t){let r=/(unexpected character|expected .*) at line (\d+) column (\d+)/i.exec(e.message);if(!r)return null;let i=Number(r[2]),s=Number(r[3]),o=iu(i,s,t),u=rn(t[o]);return new Ae(u,o)}function ru(e){let n=/unexpected (identifier|token) "(.)"/i.exec(e.message);if(!n)return null;let r=rn(n[2]);return new Ae(r,0)}function rn(e){return"0x"+e.charCodeAt(0).toString(16).toUpperCase()}function iu(e,t,n){if(e===1)return t-1;let r=1,i=0;return n.split("").find((s,o)=>(s===`
`&&(r+=1),r===e?(i=o+t,!0):!1)),i}var sn=class extends c{},Ae=class extends c{constructor(t,n){super(),this.byte=t,this.position=n}};var zr=class extends c{constructor(t){super(),this[0]=t}};function su(e,t){return gt(bs(e),n=>{let r=t(n);return ne(r,i=>new zr(i))})}function ks(e,t){return su(e,t)}function As(e){return Pr(e)}function Be(e){return e}function nt(e){return e}function $e(e){return e}function ou(){return ys()}function vs(e,t){if(e instanceof _){let n=e[0];return t(n)}else return ou()}function rt(e){return ws(e)}function qr(e){return gs(e)}function Lt(e,t){let r=L(e,t);return qr(r)}var ln=class extends c{constructor(t){super(),this.all=t}};function lu(e){return new ln(l([t=>e(t.dispatch,t.emit,t.select)]))}function Ot(e){return lu((t,n,r)=>e(t))}function E(){return new ln(l([]))}var it=class extends c{constructor(t){super(),this.content=t}},S=class extends c{constructor(t,n,r,i,s,o,u){super(),this.key=t,this.namespace=n,this.tag=r,this.attrs=i,this.children=s,this.self_closing=o,this.void=u}},Et=class extends c{constructor(t){super(),this.subtree=t}};var st=class extends c{constructor(t,n,r){super(),this[0]=t,this[1]=n,this.as_property=r}},St=class extends c{constructor(t,n){super(),this[0]=t,this[1]=n}};function au(e){if(e instanceof st)return new d(void 0);{let t=e[0],n=e[1],r=Yt(t,2);return new p([r,n])}}function Ls(e,t,n){return nr(e,t,(r,i,s)=>{let o=n+"-"+F(s);return Os(i,r,o)})}function Os(e,t,n){for(;;){let r=e,i=t,s=n;if(r instanceof it)return i;if(r instanceof Et){let o=r.subtree;e=o(),t=i,n=s}else if(r instanceof S){let o=r.attrs,u=r.children,a=te(o,i,(f,m)=>{let y=au(m);if(y.isOk()){let g=y[0][0],N=y[0][1];return ht(f,s+"-"+g,N)}else return f});return Ls(u,a,s)}else{let o=r.elements;return Ls(o,i,s)}}}function Es(e){return Os(e,pe(),"0")}function De(e,t){return new st(e,t,!1)}function Ts(e,t){return new St("on"+e,t)}function js(e){return De("style",te(e,"",(t,n)=>{let r=n[0],i=n[1];return t+r+":"+i+";"}))}function b(e){return De("class",e)}function X(e){return De("id",e)}function ve(e){return De("title",e)}function Cs(e){return De("type",e)}function Ms(e){return De("value",e)}function Ir(e){return De("href",e)}function ot(e,t,n){return e==="area"?new S("","",e,t,l([]),!1,!0):e==="base"?new S("","",e,t,l([]),!1,!0):e==="br"?new S("","",e,t,l([]),!1,!0):e==="col"?new S("","",e,t,l([]),!1,!0):e==="embed"?new S("","",e,t,l([]),!1,!0):e==="hr"?new S("","",e,t,l([]),!1,!0):e==="img"?new S("","",e,t,l([]),!1,!0):e==="input"?new S("","",e,t,l([]),!1,!0):e==="link"?new S("","",e,t,l([]),!1,!0):e==="meta"?new S("","",e,t,l([]),!1,!0):e==="param"?new S("","",e,t,l([]),!1,!0):e==="source"?new S("","",e,t,l([]),!1,!0):e==="track"?new S("","",e,t,l([]),!1,!0):e==="wbr"?new S("","",e,t,l([]),!1,!0):new S("","",e,t,n,!1,!1)}function Ns(e){return new it(e)}var Dr=class extends c{constructor(t){super(),this.dict=t}};function Ps(){return new Dr(pe())}var an=class extends c{constructor(t){super(),this[0]=t}},cn=class extends c{constructor(t,n){super(),this[0]=t,this[1]=n}},fn=class extends c{constructor(t,n){super(),this[0]=t,this[1]=n}};function zs(e){return v(e.created,pe())&&v(e.removed,Ps())&&v(e.updated,pe())}var pn=class extends c{constructor(t){super(),this[0]=t}},dn=class extends c{constructor(t,n){super(),this[0]=t,this[1]=n}},Tt=class extends c{constructor(t){super(),this[0]=t}},ce=class extends c{constructor(t){super(),this[0]=t}},jt=class extends c{constructor(t,n){super(),this[0]=t,this[1]=n}},_n=class extends c{constructor(t,n){super(),this[0]=t,this[1]=n}};var Ct=class extends c{},mn=class extends c{constructor(t,n){super(),this[0]=t,this[1]=n}},$n=class extends c{constructor(t){super(),this[0]=t}},hn=class extends c{constructor(t){super(),this[0]=t}};function Gr(e,t,n){let r,i=[{prev:e,next:t,parent:e.parentNode}];for(;i.length;){let{prev:s,next:o,parent:u}=i.pop();for(;o.subtree!==void 0;)o=o.subtree();if(o.content!==void 0)if(s)if(s.nodeType===Node.TEXT_NODE)s.textContent!==o.content&&(s.textContent=o.content),r??=s;else{let a=document.createTextNode(o.content);u.replaceChild(a,s),r??=a}else{let a=document.createTextNode(o.content);u.appendChild(a),r??=a}else if(o.tag!==void 0){let a=hu({prev:s,next:o,dispatch:n,stack:i});s?s!==a&&u.replaceChild(a,s):u.appendChild(a),r??=a}else if(o.elements!==void 0)for(let a of wn(o))i.unshift({prev:s,next:a,parent:u}),s=s?.nextSibling}return r}function hu({prev:e,next:t,dispatch:n,stack:r}){let i=t.namespace||"http://www.w3.org/1999/xhtml",s=e&&e.nodeType===Node.ELEMENT_NODE&&e.localName===t.tag&&e.namespaceURI===(t.namespace||"http://www.w3.org/1999/xhtml"),o=s?e:i?document.createElementNS(i,t.tag):document.createElement(t.tag),u;if(Mt.has(o))u=Mt.get(o);else{let w=new Map;Mt.set(o,w),u=w}let a=s?new Set(u.keys()):null,f=s?new Set(Array.from(e.attributes,w=>w.name)):null,m=null,y=null,g=null;if(s&&t.tag==="textarea"){let w=t.children[Symbol.iterator]().next().value?.content;w!==void 0&&(o.value=w)}let N=[];for(let w of t.attrs){let A=w[0],j=w[1];if(w.as_property)o[A]!==j&&(o[A]=j),s&&f.delete(A);else if(A.startsWith("on")){let ee=A.slice(2),pt=n(j,ee==="input");u.has(ee)||o.addEventListener(ee,Nt),u.set(ee,pt),s&&a.delete(ee)}else if(A.startsWith("data-lustre-on-")){let ee=A.slice(15),pt=n(xu);u.has(ee)||o.addEventListener(ee,Nt),u.set(ee,pt),o.setAttribute(A,j)}else A.startsWith("delegate:data-")||A.startsWith("delegate:aria-")?(o.setAttribute(A,j),N.push([A.slice(10),j])):A==="class"?m=m===null?j:m+" "+j:A==="style"?y=y===null?j:y+j:A==="dangerous-unescaped-html"?g=j:(o.getAttribute(A)!==j&&o.setAttribute(A,j),(A==="value"||A==="selected")&&(o[A]=j),s&&f.delete(A))}if(m!==null&&(o.setAttribute("class",m),s&&f.delete("class")),y!==null&&(o.setAttribute("style",y),s&&f.delete("style")),s){for(let w of f)o.removeAttribute(w);for(let w of a)u.delete(w),o.removeEventListener(w,Nt)}if(t.tag==="slot"&&window.queueMicrotask(()=>{for(let w of o.assignedElements())for(let[A,j]of N)w.hasAttribute(A)||w.setAttribute(A,j)}),t.key!==void 0&&t.key!=="")o.setAttribute("data-lustre-key",t.key);else if(g!==null)return o.innerHTML=g,o;let P=o.firstChild,fe=null,ge=null,ye=null,ie=xn(t).next().value;if(s&&ie!==void 0&&ie.key!==void 0&&ie.key!==""){fe=new Set,ge=Fs(e),ye=Fs(t);for(let w of xn(t))P=wu(P,w,o,r,ye,ge,fe)}else for(let w of xn(t))r.unshift({prev:P,next:w,parent:o}),P=P?.nextSibling;for(;P;){let w=P.nextSibling;o.removeChild(P),P=w}return o}var Mt=new WeakMap;function Nt(e){let t=e.currentTarget;if(!Mt.has(t)){t.removeEventListener(e.type,Nt);return}let n=Mt.get(t);if(!n.has(e.type)){t.removeEventListener(e.type,Nt);return}n.get(e.type)(e)}function xu(e){let t=e.currentTarget,n=t.getAttribute(`data-lustre-on-${e.type}`),r=JSON.parse(t.getAttribute("data-lustre-data")||"{}"),i=JSON.parse(t.getAttribute("data-lustre-include")||"[]");switch(e.type){case"input":case"change":i.push("target.value");break}return{tag:n,data:i.reduce((s,o)=>{let u=o.split(".");for(let a=0,f=s,m=e;a<u.length;a++)a===u.length-1?f[u[a]]=m[u[a]]:(f[u[a]]??={},m=m[u[a]],f=f[u[a]]);return s},{data:r})}}function Fs(e){let t=new Map;if(e)for(let n of xn(e)){let r=n?.key||n?.getAttribute?.("data-lustre-key");r&&t.set(r,n)}return t}function wu(e,t,n,r,i,s,o){for(;e&&!i.has(e.getAttribute("data-lustre-key"));){let a=e.nextSibling;n.removeChild(e),e=a}if(s.size===0)return r.unshift({prev:e,next:t,parent:n}),e=e?.nextSibling,e;if(o.has(t.key))return console.warn(`Duplicate key found in Lustre vnode: ${t.key}`),r.unshift({prev:null,next:t,parent:n}),e;o.add(t.key);let u=s.get(t.key);if(!u&&!e)return r.unshift({prev:null,next:t,parent:n}),e;if(!u&&e!==null){let a=document.createTextNode("");return n.insertBefore(a,e),r.unshift({prev:a,next:t,parent:n}),e}return!u||u===e?(r.unshift({prev:e,next:t,parent:n}),e=e?.nextSibling,e):(n.insertBefore(u,e),r.unshift({prev:u,next:t,parent:n}),e)}function*xn(e){for(let t of e.children)yield*wn(t)}function*wn(e){if(e.elements!==void 0)for(let t of e.elements)yield*wn(t);else e.subtree!==void 0?yield*wn(e.subtree()):yield e}var Rr=class e{static start({init:t,update:n,view:r},i,s){if(!Hr())return new d(new Pt);let o=i instanceof HTMLElement?i:document.querySelector(i);if(!o)return new d(new gn(i));let u=new e(o,t(s),n,r);return new p(a=>u.send(a))}constructor(t,[n,r],i,s){this.root=t,this.#e=n,this.#s=i,this.#n=s,this.#t=window.requestAnimationFrame(()=>this.#r(r.all.toArray(),!0))}root;send(t){if(t instanceof Tt){if(t[0]instanceof hn){this.#t=window.cancelAnimationFrame(this.#t),this.#i=[],this.#e=t[0][0];let n=this.#n(this.#e),r=(s,o=!1)=>u=>{let a=s(u);a instanceof p&&this.send(new ce(a[0],o))},i=this.root.firstChild??this.root.appendChild(document.createTextNode(""));Gr(i,n,r)}}else if(t instanceof ce){let n=t[0],r=t[1]??!1;this.#i.push(n),r?(this.#t=window.cancelAnimationFrame(this.#t),this.#r()):this.#t||(this.#t=window.requestAnimationFrame(()=>this.#r()))}else if(t instanceof jt){let n=t[0],r=t[1];this.root.dispatchEvent(new CustomEvent(n,{detail:r,bubbles:!0,composed:!0}))}else if(t instanceof Ct)for(this.#t=window.cancelAnimationFrame(this.#t),this.#e=null,this.#s=null,this.#n=null,this.#i=null;this.root.firstChild;)this.root.firstChild.remove()}#e;#s;#n;#i=[];#t;#r(t=[],n=!1){if(this.#t=void 0,!this.#o(t,n))return;let r=this.#n(this.#e),i=(o,u=!1)=>a=>{let f=o(a);f instanceof p&&this.send(new ce(f[0],u))},s=this.root.firstChild??this.root.appendChild(document.createTextNode(""));Gr(s,r,i)}#o(t=[],n=!1){for(;this.#i.length>0;){let r=this.#i.shift(),[i,s]=this.#s(this.#e,r);n||=this.#e!==i,t=t.concat(s.all.toArray()),this.#e=i}for(;t.length>0;)t.shift()({dispatch:u=>this.send(new ce(u)),emit:(u,a)=>this.root.dispatchEvent(new CustomEvent(u,{detail:a,bubbles:!0,composed:!0})),select:()=>{}});return this.#i.length>0?this.#o(t,n):n}},qs=Rr.start;var Ur=class e{static start({init:t,update:n,view:r,on_attribute_change:i},s){let o=new e(t(s),n,r,i);return new p(u=>o.send(u))}constructor([t,n],r,i,s){this.#e=t,this.#s=r,this.#i=i,this.#t=i(t),this.#u=s,this.#r=new Map,this.#o=Es(this.#t),this.#l(n.all.toArray())}send(t){if(t instanceof pn){for(let n of t[0]){let r=this.#u.get(n[0]);if(!r)continue;let i=r(n[1]);i instanceof d||this.#n.push(i)}this.#l()}else if(t instanceof dn)this.#n=this.#n.concat(t[0].toArray()),this.#l(t[1].all.toArray());else if(!(t instanceof Tt))if(t instanceof ce)this.#n.push(t[0]),this.#l();else if(t instanceof jt){let n=new cn(t[0],t[1]);for(let[r,i]of this.#r)i(n)}else if(t instanceof _n){let n=this.#o.get(t[0]);if(!n)return;let r=n(t[1]);if(r instanceof d)return;this.#n.push(r[0]),this.#l()}else if(t instanceof mn){let n=er(this.#u),r=new fn(n,this.#t);this.#r=this.#r.set(t[0],t[1]),t[1](r)}else t instanceof $n&&(this.#r=this.#r.delete(t[0]))}#e;#s;#n;#i;#t;#r;#o;#u;#l(t=[]){if(!this.#a(!1,t))return;let n=this.#i(this.#e),r=elements(this.#t,n);if(!zs(r)){let i=new an(r);for(let[s,o]of this.#r)o(i)}this.#t=n,this.#o=r.handlers}#a(t=!1,n=[]){for(;this.#n.length>0;){let r=this.#n.shift(),[i,s]=this.#s(this.#e,r);t||=this.#e!==i,n=n.concat(s.all.toArray()),this.#e=i}for(;n.length>0;)n.shift()({dispatch:u=>this.send(new ce(u)),emit:(u,a)=>this.root.dispatchEvent(new CustomEvent(u,{detail:a,bubbles:!0,composed:!0})),select:()=>{}});return this.#n.length>0?this.#a(t,n):t}},gu=Ur.start,Hr=()=>globalThis.window&&window.document;var Jr=class extends c{constructor(t,n,r,i){super(),this.init=t,this.update=n,this.view=r,this.on_attribute_change=i}};var gn=class extends c{constructor(t){super(),this.selector=t}},Pt=class extends c{};function Is(e,t,n){return new Jr(e,t,n,new x)}function Bs(e,t,n){return $t(!Hr(),new d(new Pt),()=>qs(e,t,n))}function h(e){return Ns(e)}function k(e,t){return ot("div",e,t)}function Wr(e,t){return ot("a",e,t)}function M(e,t){return ot("button",e,t)}function Ds(e){return ot("input",e,l([]))}function Gs(e,t){return Ts(e,t)}function T(e){return Gs("click",t=>new p(e))}function ku(e){let t=e;return O("target",O("value",_e))(t)}function Rs(e){return Gs("input",t=>{let n=ku(t);return J(n,e)})}function Kr(e,t){return globalThis.setTimeout(t,e)}var zt=class extends c{constructor(t,n,r,i){super(),this.id=t,this.name=n,this.rounds_total=r,this.rounds_remaining=i}};function Vr(e,t,n){return new zt(e,t,n,n)}function Ft(e){return e.withFields({rounds_remaining:Ce(0,e.rounds_remaining-1)})}function Us(e){return e.rounds_remaining===0?e.withFields({rounds_remaining:e.rounds_total}):e.withFields({rounds_remaining:Ce(0,e.rounds_remaining-1)})}function Yr(e){let t=e.rounds_remaining+1;return e.withFields({rounds_total:Ce(e.rounds_total,t),rounds_remaining:t})}function Hs(e){return e.rounds_remaining}function Js(e){return e.rounds_total}function Ws(e){return e.rounds_remaining<=0}function yn(e,t){return L(e,n=>n.id===t.id?t:n)}var he=class extends c{constructor(t,n,r){super(),this.name=t,this.expires_at=n,this.last_tick=r}},Ge=class extends c{constructor(t,n){super(),this.name=t,this.remaining=n}},Re=class extends c{constructor(t,n){super(),this.name=t,this.duration=n}},lt=class extends c{constructor(t,n){super(),this.name=t,this.expiration=n}},xe=class extends c{constructor(t,n){super(),this.name=t,this.remaining=n}},ut=class extends c{constructor(t,n){super(),this.name=t,this.expiration_unix=n}};function Ks(e,t){return new Re(e,t)}function Vs(e){if(e instanceof xe){let t=e.name,n=e.remaining;return new Ge(t,Sr(n))}else{let t=e.name,n=e.expiration_unix;return new lt(t,ds(n))}}function Ys(e){if(e instanceof Ge){let t=e.name,n=e.remaining;return new xe(t,tn(n,new re))}else if(e instanceof Re){let t=e.name,n=e.duration;return new xe(t,tn(n,new re))}else if(e instanceof lt){let t=e.name,n=e.expiration;return new ut(t,Mr(n))}else{let t=e.name,n=e.expires_at;return new ut(t,Mr(n))}}function Zs(e,t){if(t instanceof Re){let n=t.name,r=t.duration,i=ms(e,r);return new he(n,i,e)}else if(t instanceof lt){let n=t.name,r=t.expiration;return new he(n,r,e)}else if(t instanceof he){let n=t.name,r=t.expires_at;return new he(n,r,e)}else return t}function Xs(e){return e.name}function at(e){if(e instanceof he){let t=e.expires_at,n=e.last_tick;return!(_s(n,t)instanceof I)}else return!1}function ct(e){return e instanceof Ge}function Qs(e){if(e instanceof he){let t=e.name,n=e.expires_at,r=e.last_tick;return new Ge(t,nn(n,r))}else return e}function eo(e){if(e instanceof Ge){let t=e.name,n=e.remaining;return new Re(t,n)}else return e}function Lu(e){return F(e[0])+(()=>{let t=e[1];return t instanceof re?"s":t instanceof Pe?"m":t instanceof ze?"h":t instanceof Fe?"d":t instanceof qe?"mo":t instanceof Ie?"y":t instanceof Me?"us":t instanceof Ne?"ms":"w"})()}function bn(e){let n=tn(e,new re),r=Sr(n),i=jr(r),s=wi(i),o=Li(s,[0,new re]);return Lu(o)}function to(e){if(e instanceof Re){let t=e.duration;return bn(t)+"..."}else{if(e instanceof lt)return"...";if(e instanceof he){let t=e.expires_at,n=e.last_tick;if(at(e))return"Expired "+(()=>{let i=nn(n,t);return bn(i)})()+" ago";{let i=nn(t,n);return bn(i)}}else{let t=e.remaining;return"Paused at "+bn(t)}}}var It=class extends c{constructor(t,n,r,i,s,o){super(),this.light_timer=t,this.players=n,this.turn=r,this.gm_round_timers=i,this.risk_level=s,this.random_encounter_timer=o}},Bt=class extends c{constructor(t,n,r,i,s,o){super(),this.id=t,this.name=n,this.focusing=r,this.light_bearer=i,this.dying=s,this.round_timers=o}},Ue=class extends c{constructor(t){super(),this.player=t}},we=class extends c{},Q=class extends c{},Le=class extends c{},Dt=class extends c{};function no(e){return e instanceof Q?"Unsafe":e instanceof Le?"Risky":"Deadly"}function ro(e){return e==="Unsafe"?new _(new Q):e==="Risky"?new _(new Le):e==="Deadly"?new _(new Dt):new x}function Ou(e){return new Bt((()=>{let t=e.players,n=L(t,i=>i.id),r=te(n,0,Ce);return Or(r,1)})(),"Player "+F(xi(e.players)+1),!1,!1,!1,l([]))}function qt(e){let t=de(e.players,l([Ou(e)]));return e.withFields({players:t})}function Eu(){return Ks("Light",is(1))}function An(e){return e.withFields({light_timer:new _(Eu())})}function io(e,t){let n=e.light_timer;if(n instanceof x)return e;{let r=n[0],i=Zs(t,r);return e.withFields({light_timer:new _(i),players:(()=>{if(at(i)){let o=e.players;return L(o,u=>u.withFields({light_bearer:!1}))}else return e.players})()})}}function vn(e,t){return e.withFields({players:L(e.players,n=>n.id===t.id?t:n)})}function so(e){let t=(()=>{let r=e.turn;if(r instanceof we){let i=e.players;if(i.atLeastLength(1)){let s=i.head;return new Ue(s)}else return new we}else{let i=r.player,s=bi(e.players,o=>o.id!==i.id);if(s.atLeastLength(2)){let o=s.tail.head;return new Ue(o)}else return new we}})();return(()=>{if(t instanceof we)return e.withFields({gm_round_timers:L(e.gm_round_timers,Ft),random_encounter_timer:Us(e.random_encounter_timer)});{let r=t.player;return vn(e,r.withFields({round_timers:L(r.round_timers,Ft)}))}})().withFields({turn:t})}function oo(e,t){return e.withFields({turn:t})}function lo(e,t){return Vr((()=>{let n=e.players,r=yi(n,u=>u.round_timers),i=de(r,e.gm_round_timers),s=L(i,u=>u.id),o=te(s,0,Ce);return Or(o,1)})(),"",t)}function Xr(e,t,n){return vn(e,t.withFields({round_timers:n(t.round_timers)}))}function uo(e,t,n){return Xr(e,t,r=>$(lo(e,n),r))}function ao(e,t,n){return Xr(e,t,r=>Se(r,i=>i.id!==n.id))}function co(e,t,n,r){return Xr(e,t,i=>yn(i,r(n)))}function fo(e,t,n){return co(e,t,n,Ft)}function po(e,t,n){return co(e,t,n,Yr)}function _o(e,t){return e.withFields({gm_round_timers:$(lo(e,t),e.gm_round_timers)})}function mo(e,t){return e.withFields({gm_round_timers:Se(e.gm_round_timers,n=>n.id!==t.id)})}function $o(e,t){return e.withFields({gm_round_timers:yn(e.gm_round_timers,Ft(t))})}function ho(e,t){return e.withFields({gm_round_timers:yn(e.gm_round_timers,Yr(t))})}function xo(e){return Vr(0,"Random Encounter",e instanceof Q?2:e instanceof Le?1:0)}function Ln(){let e=new It(new x,l([]),new we,l([]),new Q,xo(new Q)),t=qt(e),n=qt(t);return qt(n)}function wo(e,t){return e.withFields({risk_level:t,random_encounter_timer:xo(t)})}function Su(e){let t=(()=>{let n=O("is_paused",Xe)(e);if(n.isOk()&&n[0])return fr((r,i)=>new xe(r,i),O("name",_e),O("remaining",be))(e);if(n.isOk()&&!n[0])return fr((r,i)=>new ut(r,i),O("name",_e),O("expiration_unix",be))(e);{let r=n[0];return new d(r)}})();return J(t,Vs)}function ei(e){return zi((t,n,r,i)=>new zt(t,n,r,i),O("id",be),O("name",_e),O("rounds_total",be),O("rounds_remaining",be))(e)}function Tu(e){return pr((t,n,r,i,s,o)=>new Bt(t,n,r,i,s,o),O("id",be),O("name",_e),O("focusing",Xe),O("light_bearer",Xe),O("dying",Xe),O("round_timers",Zt(ei)))(e)}function ju(e){let n=_e(e),r=J(n,ro);return J(r,i=>pi(i,new Q))}function go(e){let t=Ln(),n=pr((r,i,s,o,u,a)=>new It(r,i,s,o,u,a),r=>{let i=r,s=Pi("light_timer",Mi(Su))(i);return J(s,Qn)},O("players",Zt(Tu)),r=>new p(t.turn),O("gm_round_timers",Zt(ei)),O("risk_level",ju),O("random_encounter_timer",ei));return ks(e,n)}function Mu(e){let n=no(e);return Be(n)}function Nu(e){let t=Ys(e);return rt(l([["name",(()=>{let r=Xs(e);return Be(r)})()],["is_paused",(()=>{let r=ct(e);return nt(r)})()],(()=>{if(t instanceof xe){let n=t.remaining;return["remaining",$e(n)]}else{let n=t.expiration_unix;return["expiration_unix",$e(n)]}})()]))}function ti(e){return rt(l([["id",(()=>{let t=e.id;return $e(t)})()],["name",(()=>{let t=e.name;return Be(t)})()],["rounds_total",(()=>{let t=e.rounds_total;return $e(t)})()],["rounds_remaining",(()=>{let t=e.rounds_remaining;return $e(t)})()]]))}function Pu(e){return rt(l([["id",(()=>{let t=e.id;return $e(t)})()],["name",(()=>{let t=e.name;return Be(t)})()],["focusing",(()=>{let t=e.focusing;return nt(t)})()],["light_bearer",(()=>{let t=e.light_bearer;return nt(t)})()],["dying",(()=>{let t=e.dying;return nt(t)})()],["round_timers",(()=>{let t=e.round_timers;return Lt(t,ti)})()]]))}function zu(e){return rt(l([["light_timer",(()=>{let t=e.light_timer;return vs(t,Nu)})()],["players",(()=>{let t=e.players;return Lt(t,Pu)})()],["gm_round_timers",(()=>{let t=e.gm_round_timers;return Lt(t,ti)})()],["risk_level",Mu(e.risk_level)],["random_encounter_timer",ti(e.random_encounter_timer)]]))}function yo(e){let n=zu(e);return As(n)}function ni(){try{return globalThis.Storage&&globalThis.localStorage instanceof globalThis.Storage?new p(globalThis.localStorage):new d(null)}catch{return new d(null)}}function ri(e,t){return qu(e.getItem(t))}function ii(e,t,n){try{return e.setItem(t,n),new p(null)}catch{return new d(null)}}function qu(e){return e!==null?new p(e):new d(null)}function bo(){let e=ni();return ne(e,t=>"Local storage not available")}function Bu(e,t){return W(bo(),n=>{let r=ii(n,t,e);return ne(r,i=>"Storage full?")})}function ko(e,t,n){return Ot(r=>{let i=Bu(e,t),s=n(i);return r(s)})}function Du(e){return W(bo(),t=>{let n=ri(t,e);return ne(n,r=>e+" not found")})}function Ao(e,t){return Ot(n=>{let r=Du(e),i=t(r);return n(i)})}var En=class extends c{constructor(t,n){super(),this.game=t,this.editing=n}},Sn=class extends c{constructor(t){super(),this[0]=t}},Tn=class extends c{},jn=class extends c{constructor(t,n){super(),this[0]=t,this[1]=n}},Cn=class extends c{constructor(t){super(),this[0]=t}},Mn=class extends c{},Nn=class extends c{constructor(t){super(),this[0]=t}},Pn=class extends c{},zn=class extends c{constructor(t){super(),this[0]=t}},Fn=class extends c{constructor(t){super(),this[0]=t}},qn=class extends c{constructor(t){super(),this[0]=t}},Gt=class extends c{},In=class extends c{},Bn=class extends c{},Dn=class extends c{constructor(t,n){super(),this[0]=t,this[1]=n}},Gn=class extends c{constructor(t,n){super(),this[0]=t,this[1]=n}},Rn=class extends c{constructor(t,n){super(),this[0]=t,this[1]=n}},Un=class extends c{constructor(t,n){super(),this[0]=t,this[1]=n}},Hn=class extends c{constructor(t){super(),this[0]=t}},Jn=class extends c{constructor(t){super(),this[0]=t}},Wn=class extends c{constructor(t){super(),this[0]=t}},Kn=class extends c{constructor(t){super(),this[0]=t}},li=class extends c{constructor(t){super(),this[0]=t}},Vn=class extends c{constructor(t){super(),this[0]=t}},Yn=class extends c{constructor(t){super(),this[0]=t}},Zn=class extends c{constructor(t,n,r,i){super(),this.add=t,this.inc=n,this.dec=r,this.remove=i}};function B(e,t){return e.withFields({game:t(e.game)})}function On(e,t){return t.withFields({game:vn(t.game,e)})}function ft(){return Ot(e=>{Kr(250,()=>e(new Sn($s())))})}function Ru(e){return e instanceof Q?"Unsafe":e instanceof Le?"Risky":"Deadly"}function si(e,t){return M(l([T(new li(e)),b(v(t.risk_level,e)?"selected":"unselected")]),l([h(Ru(e))]))}function oi(e,t){let n=Hs(e.random_encounter_timer),r=Js(e.random_encounter_timer),i=n===t,s=r<t;return i?"current":!i&&s?"disabled":"just-whatever"}function Uu(e){let t=e.game.light_timer;if(t instanceof x)return k(l([X("light-timer")]),l([M(l([T(new Gt)]),l([h("Start Light Timer")]))]));{let n=t[0];return k(l([X("light-timer"),b(at(n)?"expired":"running")]),l([k(l([b("button-row")]),l([M(l([T(new In)]),l([h("Clear")])),M(l([T(new Bn)]),l([h(ct(n)?"Resume":"Pause")])),M(l([T(new Gt)]),l([h("Restart")]))])),k(l([b("description")]),l([k(l([]),l([h(to(n))]))]))]))}}function Hu(e,t){return k(l([b("timer"),b(Ws(t)?"expired":"running")]),l([k(l([b("description")]),l([k(l([]),l([h((()=>{let n=t.rounds_remaining;return F(n)})()),h(" / "),h((()=>{let n=t.rounds_total;return F(n)})())]))])),k(l([b("button-row")]),l([M(l([T(e.inc(t)),ve("add 1 round")]),l([h("+")])),M(l([T(e.dec(t)),ve("subtract 1 round")]),l([h("-")])),M(l([T(e.remove(t)),ve("remove timer")]),l([h("X")]))]))]))}function Lo(e,t){return k(l([b("round-timers")]),$(k(l([b("button-row")]),l([M(l([T(e.add(1))]),l([h("\u23F2\uFE0F1")])),M(l([T(e.add(5))]),l([h("\u23F2\uFE0F5")])),M(l([T(e.add(10))]),l([h("\u23F2\uFE0F10")]))])),L(t,r=>Hu(e,r))))}function vo(e){let t=e.game;return L(t.players,n=>{let r=l(["player"]),i=(()=>{let a=t.turn;if(a instanceof Ue&&a.player.id===n.id){let f=a.player;return $("current-turn",r)}else return r})(),s=n.focusing?$("focusing",i):i,o=n.light_bearer?$("light-bearer",s):s,u=n.dying?$("dying",o):o;return k(L(u,b),l([k(l([b("name")]),l([e.editing?Ds(l([Cs("text"),Ms(n.name),Rs(f=>new jn(n,f))])):k(l([T(new Nn(new Ue(n))),js(l([["cursor","pointer"]])),ve("Jump current turn")]),l([h(n.name)]))])),k(l([b("button-row"),b("primary-toggles")]),l([M(l([b("light-bearer"),ve(n.light_bearer?"Light-Bearer":"Not carrying a light"),T(new zn(n))]),l([h("\u{1F525}")])),M(l([b("focusing"),ve(n.focusing?"Focusing":"Not focusing"),T(new Fn(n))]),l([h("\u{1F4AD}")])),M(l([b("dying"),ve(n.dying?"Dying":"Not dying"),T(new qn(n))]),l([h("\u{1F480}")]))])),Lo(new Zn(a=>new Dn(n,a),a=>new Un(n,a),a=>new Rn(n,a),a=>new Gn(n,a)),n.round_timers),e.editing?M(l([T(new Cn(n))]),l([h("Remove")])):h("")]))})}function Ju(e){let t=e.game,n=t.turn instanceof we?l([b("current-turn")]):l([]);return k($(X("gm-bar"),n),l([k(l([X("random-encounter-timer")]),l([k(l([b("button-row")]),l([si(new Q,t),si(new Le,t),si(new Dt,t)])),k(l([b("indicator")]),l([k(l([b("item"),b(oi(t,2))]),l([h("\u25CF")])),k(l([b("item"),b(oi(t,1))]),l([h("\u25CF")])),k(l([X("random-encounter-now"),b("item"),b(oi(t,0))]),l([h("\u{1F3B2}")]))]))])),Lo(new Zn(r=>new Hn(r),r=>new Kn(r),r=>new Wn(r),r=>new Jn(r)),t.gm_round_timers),Uu(e),k(l([X("big-buttons")]),l([M(l([X("toggle-edit"),T(new Pn)]),l([h("Toggle Editing")])),M(l([X("next-turn"),T(new Mn)]),l([h("Next Turn")]))]))]))}function Wu(){return k(l([X("footer")]),l([h("Made with \u{1FA78} by John D. Hume, "),Wr(l([Ir("https://www.duelinmarkers.com/")]),l([h("duelinmarkers.com")])),h(", "),Wr(l([Ir("https://hachyderm.io/@duelinmarkers")]),l([h("hachyderm.io/@duelinmarkers")])),h(".")]))}function Ku(e){return k(l([X("main")]),l([k(l([X("players")]),e.editing?de(vo(e),l([M(l([T(new Tn)]),l([h("Add Player")]))])):vo(e)),Ju(e),Wu()]))}var Oo="shadowboard_game:First Table";function Vu(e){return[new En(Ln(),!0),Ao(Oo,n=>new Yn(n))]}function Yu(e){let t=e.game,n=yo(t);return ko(n,Oo,r=>new Vn(r))}function He(e,t){let n=B(e,t);return[n,Yu(n)]}function Zu(e,t){let n=e.game;if(t instanceof Vn){let r=t[0],i=ne(r,Nr);return[e,E()]}else if(t instanceof Yn){let r=t[0],i=W(r,s=>{let u=go(s);return ne(u,yt)});if(i.isOk()){let s=i[0];return xs("Loaded game"),[new En(s,!1),ft()]}else{let s=Nr(i);return[e,E()]}}else if(t instanceof Sn){let r=t[0],i=B(e,o=>io(o,r));return v(e.game,i.game)?[e,E()]:[i,ft()]}else{if(t instanceof Gt)return[B(e,An),(()=>{let r=n.light_timer;if(r instanceof x)return ft();{let i=r[0];return ct(i)?ft():E()}})()];if(t instanceof In)return[B(e,r=>r.withFields({light_timer:new x,players:(()=>{let i=r.players;return L(i,s=>s.withFields({light_bearer:!1}))})()})),E()];if(t instanceof Bn){let r=n.light_timer,i=(()=>{let s=n.light_timer;return Jt(s,ct)})();if(r instanceof _&&i instanceof _&&i[0]){let s=r[0];return[B(e,o=>o.withFields({light_timer:new _(eo(s))})),ft()]}else if(r instanceof _){let s=r[0];return[B(e,o=>o.withFields({light_timer:new _(Qs(s))})),E()]}else return[e,E()]}else{if(t instanceof Tn)return[B(e,qt),E()];if(t instanceof Cn){let r=t[0];return[B(e,i=>i.withFields({players:Se(i.players,s=>s.id!==r.id)})),E()]}else if(t instanceof jn){let r=t[0],i=t[1];return[On(r.withFields({name:i}),e),E()]}else if(t instanceof zn){let r=t[0],i=!r.light_bearer,s=(()=>{let a=(()=>{let f=e.game.light_timer;return Jt(f,at)})();return i&&a instanceof x?[B(e,An),ft()]:i&&a instanceof _&&a[0]?[B(e,An),E()]:[e,E()]})(),o=s[0],u=s[1];return[On(r.withFields({light_bearer:i}),o),u]}else if(t instanceof Fn){let r=t[0];return[On(r.withFields({focusing:!r.focusing}),e),E()]}else if(t instanceof qn){let r=t[0];return[On(r.withFields({light_bearer:!1,focusing:!1,dying:!r.dying}),e),E()]}else if(t instanceof Dn){let r=t[0],i=t[1];return He(e,s=>uo(s,r,i))}else if(t instanceof Hn){let r=t[0];return He(e,i=>_o(i,r))}else{if(t instanceof Mn)return He(e,so);if(t instanceof Nn){let r=t[0];return He(e,i=>oo(i,r))}else{if(t instanceof Pn)return[e.withFields({editing:!e.editing}),E()];if(t instanceof Gn){let r=t[0],i=t[1];return He(e,s=>ao(s,r,i))}else if(t instanceof Rn){let r=t[0],i=t[1];return[B(e,s=>fo(s,r,i)),E()]}else if(t instanceof Un){let r=t[0],i=t[1];return[B(e,s=>po(s,r,i)),E()]}else if(t instanceof Jn){let r=t[0];return He(e,i=>mo(i,r))}else if(t instanceof Wn){let r=t[0];return[B(e,i=>$o(i,r)),E()]}else if(t instanceof Kn){let r=t[0];return[B(e,i=>ho(i,r)),E()]}else{let r=t[0];return He(e,i=>wo(i,r))}}}}}}function Eo(){let e=Is(Vu,Zu,Ku),t=Bs(e,"#app",void 0);if(!t.isOk())throw Ke("let_assert","app",29,"main","Pattern match failed, no pattern matched the value.",{value:t})}Eo();
